"use strict";(self.webpackChunkbodo_jupyterlab=self.webpackChunkbodo_jupyterlab||[]).push([[580],{6580:(e,t,s)=>{s.r(t),s.d(t,{default:()=>we});var n=s(257),a=s(2478),r=s(1840),o=s(7543),i=s(8957);async function l(e="",t={}){const s=i.ServerConnection.makeSettings(),n=o.URLExt.join(s.baseUrl,e);let a;console.debug("handler.ts:requestAPI:requestUrl: ",n);try{a=await i.ServerConnection.makeRequest(n,t,s)}catch(e){throw console.error("handler.ts:requestAPI:error: ",e),new i.ServerConnection.NetworkError(e)}const r=await a.json();if(console.debug("handler.ts:requestAPI:data: ",r),!a.ok)throw new i.ServerConnection.ResponseError(a,r.message);return r}async function c(e){try{await l(`bodo/cluster/${e}/resume`,{method:"Put"})}catch(e){throw new Error(e)}}const d=new(s(7349).LRUCache)({maxSize:1});async function u(){const e=d.get("data");if(e)return Promise.resolve(e);const t=await l("bodo/config",{method:"GET"});if(t.e)throw new Error(t.e);return d.set("data",t),t}var h=s(5777);class m{constructor(){this._clusterListErrorShown=!1,this._clusters=[],this.updateClusters(!1),this._clusterChanged=new r.Signal(this),this._poll=new a.Poll({factory:async()=>{await this.updateClusters(!1)},frequency:{interval:5e3,backoff:!0,max:6e4},standby:"when-hidden"}),this._poll.start()}get clusters(){return this._clusters}get clusterChaged(){return this._clusterChanged}async getClustersList(e=!1){try{return e?await async function(){const e=await l("bodo/cluster?forceRefresh=True",{method:"GET"});if(e.e)throw new Error(e.e);return e.clusters}():await async function(){const e=await l("bodo/cluster?forceRefresh=False",{method:"GET"});if(e.e)throw new Error(e.e);return e.clusters}()}catch(e){return console.error("Error in ClusterStore.getClustersList: ",e),this._clusterListErrorShown||((0,h.showErrorMessage)("Bodo Extension Error: Unable to get cluster list",e),this._clusterListErrorShown=!0),[]}}async forceUpdate(){try{await this.updateClusters(!0)}catch(e){console.error("Error in ClusterStore.forceUpdate: ",e),this._clusterListErrorShown||((0,h.showErrorMessage)("Bodo Extension Error: Unable to get cluster list",e),this._clusterListErrorShown=!0)}}clusterListHasChanged(e,t){if(e.length!==t.length)return!0;e.sort(((e,t)=>e.uuid<t.uuid?-1:1)),t.sort(((e,t)=>e.uuid<t.uuid?-1:1));for(let s=0;s<e.length;s++)if(JSON.stringify(e[s])!==JSON.stringify(t[s]))return!0;return!1}async updateClusters(e=!1){const t=await this.getClustersList(e);this.clusterListHasChanged(this._clusters,t)&&(this._clusterChanged.emit({name:"cluster",oldValue:this._clusters,newValue:t}),this._clusters=t)}}var g,p,w=s(693),_=s(5923),E=s(6271),v=s.n(E);!function(e){e.NEW="NEW",e.INPROGRESS="INPROGRESS",e.ASGCREATED="ASGCREATED",e.INITIALIZING="INITIALIZING",e.SCALING="SCALING",e.RUNNING="RUNNING",e.FAILED="FAILED",e.TERMINATING="TERMINATING",e.TERMINATED="TERMINATED",e.PAUSING="PAUSING",e.PAUSED="PAUSED",e.RESUMING="RESUMING",e.STOPPING="STOPPING",e.STOPPED="STOPPED"}(g||(g={})),function(e){e.PARALLEL_PYTHON="Parallel-Python",e.PYTHON="Python",e.SQL="SQL"}(p||(p={}));var C=s(8954);const f=({cluster:e,current:t=!1,callback:s})=>v().createElement("div",{className:(t?"current-cluster-option":"")+" bodo-cluster-dropdown-item",onClick:t?()=>!0:()=>s(e.uuid),key:e.uuid},v().createElement("div",null,v().createElement("span",{className:"cluster-name"},e.name),v().createElement("span",{className:"cluster-details"},"Bodo ",e.bodoVersion)),t&&v().createElement("button",{onClick:()=>s()},"Detach")),y=({cluster:e,forceUpdate:t})=>{const[s,n]=(0,E.useState)(!1);return v().createElement("div",{className:"bodo-cluster-dropdown-item paused-bodo-clusuter",key:e.uuid},v().createElement("div",null,v().createElement("span",{className:"cluster-name"},e.name),v().createElement("span",{className:"cluster-details"},"Bodo ",e.bodoVersion)),e.status!==g.PAUSED||s?v().createElement("div",{className:"cluster-select-resume-loading"},v().createElement(C.Grid,{ariaLabel:"loading-indicator",width:10,height:10})):v().createElement("div",{className:"cluster-select-resume-cluster",onClick:(a=e.uuid,async e=>{if(!confirm("Are you sure that you want to resume this cluster"))return!1;await c(a),t&&t(),n(!0),setTimeout((()=>n(!1)),5e3)})},v().createElement("svg",{width:"35",height:"47",viewBox:"0 0 35 47",fill:"none",xmlns:"http://www.w3.org/2000/svg"},v().createElement("path",{d:"M33.992 25.435C34.3029 25.2194 34.5571 24.9309 34.7327 24.5944C34.9083 24.2579 35 23.8834 35 23.5032C35 23.123 34.9083 22.7485 34.7327 22.412C34.5571 22.0754 34.3029 21.7869 33.992 21.5713L3.66075 0.419678C3.3109 0.174847 2.90114 0.0312738 2.47598 0.00455464C2.05081 -0.0221645 1.62651 0.0689923 1.24916 0.268124C0.871822 0.467255 0.555873 0.766742 0.335644 1.13405C0.115415 1.50135 -0.000670061 1.92243 9.40679e-07 2.35153L2.78982e-06 44.6548C0.00175831 45.0829 0.119337 45.5025 0.340093 45.8683C0.560849 46.2341 0.876431 46.5324 1.2529 46.7311C1.62937 46.9297 2.05248 47.0213 2.47674 46.9958C2.90099 46.9704 3.31034 46.8289 3.66075 46.5867L33.992 25.435Z",fill:"#5E5E5E"}))));var a};function S(e,t){return e.status===t.status?0:e.status===g.RUNNING?-1:t.status===g.RUNNING?1:e.status===g.INITIALIZING?-1:t.status===g.INITIALIZING?1:0}const b=()=>v().createElement("svg",{height:"20",className:"bodo-select-chevron",width:"20",viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false"},v().createElement("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"})),N=({cluster:e,isProcessing:t})=>v().createElement(v().Fragment,null,v().createElement("div",{className:"bodo-currently-selected-dropdown"},t?v().createElement("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"}},v().createElement("span",null,"Loading..."),v().createElement("span",null,v().createElement(C.Grid,{ariaLabel:"loading-indicator",width:10,height:10}))):v().createElement(v().Fragment,null,v().createElement("span",null,e?e.name:"Detached"),v().createElement(b,null)))),I=({currentClusterUUID:e,myOnChange:t,clusters:s,clusterAttachloading:n,store:a})=>{const[r,o]=(0,E.useState)(!1),[i,l]=(0,E.useState)(!1),c=(0,E.useRef)(null),d=e=>s.find((t=>t.uuid===e)),u=(e,s)=>{l(!0),t(s?"0":e),setTimeout((()=>{l(!1)}),1e3),o(!1)},h=e=>{u(e,!1)},m=e=>{u(e,!0)},p=d(e),{current:w}=c;return!w||w.status!==g.RUNNING||p&&p.status===g.RUNNING||m("0"),c.current=p,v().createElement(v().Fragment,null,v().createElement("div",{className:"bodo-dropdown-container"},v().createElement("div",{onClick:()=>{o(!r)}},v().createElement(N,{cluster:e?d(e):null,isProcessing:i||n})),v().createElement("div",{className:"bodo-dropdown-list "+(r?"selecting":"")},0===s.length?v().createElement("div",{className:"bodo-dropdown-item"},v().createElement("div",null,v().createElement("span",{className:"cluster-name"},"No Clusters Available"))):v().createElement(v().Fragment,null,p?v().createElement(v().Fragment,null,v().createElement("div",{className:"bodo-drop-down-details"},"Attached Cluster:"),v().createElement(f,{cluster:p,current:!0,callback:m}),v().createElement("div",{className:"bodo-drop-down-details"},"Detach & Attach:")):v().createElement("div",{className:"bodo-drop-down-details"},"Attach:"),(()=>{const t=d(e);return s.filter((e=>e.status!==g.NEW)).sort(S).filter((s=>!t||e!==s.uuid)).map((e=>e.status===g.RUNNING?v().createElement(f,{cluster:e,callback:h}):v().createElement(y,{forceUpdate:()=>a.forceUpdate(),cluster:e})))})()))))},L=({panel:e})=>{const{data:t}=(0,w.useQuery)(["catalogs"],(()=>(async()=>{try{return async function(){const e=await l("bodo/catalog?forceRefresh=True",{method:"GET"});if(e.e)throw new Error(e.e);return e.catalogs}()}catch(e){return console.error("Error fetching catalogs",e),[]}})()),{refetchInterval:6e4}),[s,n]=(0,E.useState)(!0),[a,r]=(0,E.useState)(void 0);return(0,E.useEffect)((()=>{e.context.ready.then((()=>{var t;n(!1),r(null===(t=e.model)||void 0===t?void 0:t.metadata.get("bodo-catalog"))}))}),[]),v().createElement("div",{className:"jp-HTMLSelect jp-DefaultStyle"},v().createElement("select",{style:{marginInline:"5px",color:"black"},disabled:s,onChange:t=>{var s,n,a,o;null===(s=e.model)||void 0===s||s.metadata.set("bodo-catalog",t.target.value);const i=null!==(a=null===(n=null==e?void 0:e.model)||void 0===n?void 0:n.cells.length)&&void 0!==a?a:0;for(let s=0;s<i;s++){const n=null===(o=null==e?void 0:e.model)||void 0===o?void 0:o.cells.get(s);null==n||n.metadata.set("bodo-catalog",t.target.value)}r(t.target.value)},value:a,placeholder:"Select catalog"},v().createElement("option",{value:"",selected:!a},"Select Catalog"),null==t?void 0:t.map((e=>v().createElement("option",{value:JSON.stringify(e)},e.name)))),v().createElement("span",{className:"f1ozlkqi"},v().createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",viewBox:"0 0 18 18","data-icon":"ui-components:caret-down-empty"},v().createElement("g",{xmlns:"http://www.w3.org/2000/svg",className:"jp-icon3",fill:"#616161",shapeRendering:"geometricPrecision"},v().createElement("path",{d:"M5.2,5.9L9,9.7l3.8-3.8l1.2,1.2l-4.9,5l-4.9-5L5.2,5.9z"})))))};class T extends E.Component{constructor(e){super(e),this.state={clusters:e.store.clusters,currentClusterUUID:null,autoAttachState:null,clusterAttachloading:!1},this._tryAutoAttach()}componentDidMount(){this.props.store.clusterChaged.connect(this._onClusterUpdate,this),this.props.sessionContext.sessionChanged.connect(this._onSessionUpdate,this)}componentWillUnmount(){this.props.store.clusterChaged.disconnect(this._onClusterUpdate,this),this.props.sessionContext.sessionChanged.disconnect(this._onSessionUpdate,this)}async _onSessionUpdate(e,t){var s,n;console.log("Detected Session Change.");const{clusters:a}=this.state;if(null===(n=null===(s=t.newValue)||void 0===s?void 0:s._kernel)||void 0===n?void 0:n._name){if(console.debug("Session Change New Kernel Name: ",t.newValue._kernel._name),"bodo_platform_dummy_kernel"===t.newValue._kernel._name)return;this.props.getClusterUUIDFromKernel(t.newValue._kernel._name).then((e=>{const t=a.find((t=>t.uuid===e));t&&t.status===g.RUNNING?(console.debug("Found cluster for this kernel: ",e),this.setState({currentClusterUUID:e})):(console.debug("Cluster not found or not running, setting currentClusterUUID to null."),this.setState({currentClusterUUID:null}),this.props.startKernelForCluster())}),(e=>{console.error("Error while getting cluster UUID from kernel: ",e),console.error("Setting currentClusterUUID to null."),this.setState({currentClusterUUID:null})}))}else console.debug("Session has no kernel. Setting currentClusterUUID to null."),this.setState({currentClusterUUID:null})}async _onClusterUpdate(e,t){const{currentClusterUUID:s}=this.state;let n;n=t.newValue?t.newValue:[];let a=s;s&&!n.map((e=>e.uuid)).includes(s)&&(a=null,await(0,h.showErrorMessage)("Cluster not available anymore!","The cluster was removed or is being modified. Your session will be shutdown."),await this.props.startKernelForCluster()),this.setState({clusters:n,currentClusterUUID:a}),await this._tryAutoAttach()}async _tryAutoAttach(){const{clusters:e,currentClusterUUID:t,autoAttachState:s}=this.state;let n=s,a=t;const r=e.filter((e=>e.status===g.RUNNING));this.setState({clusterAttachloading:!0}),null===s&&(n=(await u()).auto_attach),!t&&1===r.length&&n&&this.props.startKernelForCluster(r[0].uuid).then((e=>{e&&(a=r[0].uuid)})),this.setState({currentClusterUUID:a,autoAttachState:n,clusterAttachloading:!1})}selectClusterCallback(e){console.debug("[onSelectCluster] clusterUUID: ",e),this.setState({clusterAttachloading:!0});const{startKernelForCluster:t}=this.props;"0"===e?(t(),this.setState({currentClusterUUID:null,clusterAttachloading:!1})):t(e).then((t=>{t?this.setState({currentClusterUUID:e,clusterAttachloading:!1}):this.setState({currentClusterUUID:null,clusterAttachloading:!1})}))}render(){const{clusters:e,currentClusterUUID:t,clusterAttachloading:s}=this.state;return E.createElement(I,{store:this.props.store,clusterAttachloading:s,myOnChange:this.selectClusterCallback.bind(this),clusters:e,currentClusterUUID:t})}}class A{constructor(e,t){this._store=e,this._catalog_mode=t,this._setCatalogMode()}async _setCatalogMode(){let e=this._catalog_mode;null===e&&(e=(await u()).catalog_mode),this._catalog_mode=e}createNew(e,t){const s=new w.QueryClient,n=h.ReactWidget.create(E.createElement(w.QueryClientProvider,{client:s},E.createElement(T,{store:this._store,startKernelForCluster:async e=>{if(!e)return console.log("No clusterUUID. Shutting session down..."),(async()=>(await t.sessionContext.shutdown(),!0))();let s;console.log("Starting Kernel for clusterUUID: ",e),console.debug("Contacting Jupyter Server App to start remote kernel for clusterUUID: ",e);try{s=await async function(e){const t=await l(`cluster-remote-ikernel/${e}`,{method:"POST"});if(t.e)throw new Error(t.e);return t.remote_kernel_name}(e)}catch(e){return console.error("Unable to register a remote kernel: ",e),(0,h.showErrorMessage)("Bodo Extension Error: Unable to create a remote kernel on the cluster.",e),!1}return console.log("Refreshing kernel specs and changing to remote kernel: ",s),await t.sessionContext.specsManager.refreshSpecs(),await t.sessionContext.changeKernel({name:s}),!0},getClusterUUIDFromKernel:async e=>{var s;if(console.debug("[getClusterUUIDFromKernel] kernelName: ",e),console.debug("[getClusterUUIDFromKernel] KernelSpecs: ",null===(s=t.sessionContext.specsManager.specs)||void 0===s?void 0:s.kernelspecs),t.sessionContext.specsManager.specs&&e in t.sessionContext.specsManager.specs.kernelspecs){const s=t.sessionContext.specsManager.specs.kernelspecs[e];if(s){const e=s.metadata;if(e&&"BodoClusterUUID"in e)return e.BodoClusterUUID}}return null},sessionContext:t.sessionContext}))),a=h.ReactWidget.create(E.createElement(w.QueryClientProvider,{client:s},E.createElement(L,{panel:e})));e.toolbar.insertItem(0,"clusterSelect",n);const r=this._catalog_mode;return r&&e.toolbar.insertItem(10,"catalogSelect",a),new _.DisposableDelegate((()=>{n.dispose(),r&&a.dispose()}))}}var U=s(7423),R=s(1139),D=s(5329);const k={id:"jupyterlab-codecellselect:factory",provides:U.NotebookPanel.IContentFactory,requires:[R.IEditorServices],autoStart:!0,activate:(e,t)=>{const s=t.factoryService.newInlineEditor;return new P({editorFactory:s})}};class P extends U.NotebookPanel.ContentFactory{constructor(e){super(e),this._RENDER_HEADER=null,this._CATALOG_MODE=null,this._setCatalogMode()}get RENDER_HEADER(){return this._RENDER_HEADER}set RENDER_HEADER(e){this._RENDER_HEADER=e}async _setCatalogMode(){let e=this._CATALOG_MODE;null===e&&(e=(await u()).catalog_mode),this._CATALOG_MODE=e}createCellHeader(){return this.RENDER_HEADER?new x(this._CATALOG_MODE):new D.CellHeader}createCodeCell(e,t){var s;return this.RENDER_HEADER=!0,new M(e,null===(s=t.model)||void 0===s?void 0:s.metadata.get("bodo-catalog"))}createMarkdownCell(e,t){return this.RENDER_HEADER=!1,super.createMarkdownCell(e,t)}createRawCell(e,t){return this.RENDER_HEADER=!1,super.createRawCell(e,t)}}class M extends D.CodeCell{constructor(e,t){super(e),this.outputFooterNode=null,this.setMimeType=this.setMimeType.bind(this);const s=this.getCellHeader();if(s){s.getLangChanged().connect(this.setLangMetadata,this);const e=this.model.metadata.get("lang")||p.PARALLEL_PYTHON;s.setLang(e),this.ready.then((()=>this.setMimeType(this.getMimeTypeFromLang(e))))}this.ready.then((()=>this.model.metadata.set("bodo-catalog",t)))}getMimeTypeFromLang(e){return e===p.SQL?"text/x-sql":"text/x-python"}setLangMetadata(e,t){this.model.metadata.set("lang",t),this.setMimeType(this.getMimeTypeFromLang(t))}setOutputMetadata(e,t){this.model.metadata.set("output",t)}setMimeType(e){this.editorWidget.model.mimeType=e}getCellHeader(){let e=null;const t=this.children();for(let s=t.next();s;s=t.next())if(s.hasClass("jp-Cell-header")){e=s;break}return e}}class x extends h.ReactWidget{constructor(e=!1){super(),this._langChanged=new r.Signal(this),this._isSelectingSignal=new r.Signal(this),this._lang=p.PARALLEL_PYTHON,this._output="",this._isSelecting=!1,this.catalogMode=!1,this.handleToggle=this.handleToggle.bind(this),this.setLangParallelPython=this.setLangParallelPython.bind(this),this.setLangPython=this.setLangPython.bind(this),this.setLangSQL=this.setLangSQL.bind(this),this.setLang=this.setLang.bind(this),this.catalogMode=e}handleToggle(){this._isSelecting=!this._isSelecting,this._isSelectingSignal.emit(this._isSelecting)}setLangParallelPython(){this._lang=p.PARALLEL_PYTHON,this._langChanged.emit(this._lang),this.handleToggle()}setLangPython(){this._lang=p.PYTHON,this._langChanged.emit(this._lang),this.handleToggle()}setLangSQL(){this._lang=p.SQL,this._langChanged.emit(this._lang),this.handleToggle()}setLang(e){this._lang=e,this._langChanged.emit(e)}getLangChanged(){return this._langChanged}render(){return v().createElement("select",{style:{border:"none",background:"#A0B2DB",color:"black",position:"absolute",height:"17px",fontSize:"12px",zIndex:998,right:"0px",top:"-17px"},onChange:e=>{this._lang=e.target.value,this._langChanged.emit(this._lang),this.handleToggle()}},v().createElement(h.UseSignal,{signal:this._langChanged,initialArgs:this._lang},((e,t)=>v().createElement(v().Fragment,null,v().createElement("option",{value:p.PARALLEL_PYTHON,selected:p.PARALLEL_PYTHON===t},"Parallel-Python"),this.catalogMode?v().createElement("option",{value:p.SQL,selected:p.SQL===t},"SQL"):null,v().createElement("option",{value:p.PYTHON,selected:p.PYTHON===t},"Python")))))}}var O=s(4497),G=s(1309);const F=({clusterStatus:e,uuid:t,startLoading:s,forceUpdate:n})=>{return v().createElement(v().Fragment,null,[g.RUNNING,g.INITIALIZING].includes(e)&&v().createElement("div",{className:"bodo-cluster-list-pause-unpause","data-tooltip-id":"pause-cluster-tooltip","data-tooltip-content":"Pause Cluster",onClick:(a=t,async()=>{if(!confirm("Are you sure that you want to pause this cluster? Make sure not to pause clusters while the kernel is connecting."))return!1;await async function(e){try{await l(`bodo/cluster/${e}/pause`,{method:"Put"})}catch(e){throw new Error(e)}}(a),s(g.PAUSING),n()})},v().createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"1em",viewBox:"0 0 320 512"},v().createElement("path",{d:"M48 64C21.5 64 0 85.5 0 112V400c0 26.5 21.5 48 48 48H80c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48H48zm192 0c-26.5 0-48 21.5-48 48V400c0 26.5 21.5 48 48 48h32c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48H240z"})),v().createElement(G.Tooltip,{id:"pause-cluster-tooltip"})),[g.PAUSED].includes(e)&&v().createElement("div",{className:"bodo-cluster-list-pause-unpause","data-tooltip-id":"resume-cluster-tooltip","data-tooltip-content":"Resume Cluster",onClick:(e=>async()=>{if(!confirm("Are you sure that you want to resume this cluster"))return!1;await c(e),s(g.RESUMING),n()})(t)},v().createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"1em",viewBox:"0 0 384 512"},v().createElement("path",{d:"M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"})),v().createElement(G.Tooltip,{id:"resume-cluster-tooltip"})));var a},j=({status:e})=>v().createElement("div",{className:`cluster-status ${e.toLowerCase()}`},e),q=({app:e,cluster:t})=>v().createElement(v().Fragment,null,[g.RUNNING,g.INITIALIZING].includes(t.status)?v().createElement("div",{className:"bodo-cluster-list-terminal",onClick:()=>{e.commands.execute("terminal:create-new",{cluster:JSON.stringify(t)})},"data-tooltip-id":"terminal-tooltip","data-tooltip-content":"Open Terminal"},v().createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24",width:"24",version:"1.1"},v().createElement("g",{transform:"translate(0 -1028.4)"},v().createElement("path",{d:"m3 1030.4c-1.1046 0-2 0.9-2 2v7 2 7c0 1.1 0.8954 2 2 2h9 9c1.105 0 2-0.9 2-2v-7-2-7c0-1.1-0.895-2-2-2h-9-9z",fill:"#2c3e50"}),v().createElement("path",{d:"m3 2c-1.1046 0-2 0.8954-2 2v3 3 1 1 1 3 3c0 1.105 0.8954 2 2 2h9 9c1.105 0 2-0.895 2-2v-3-4-2-3-3c0-1.1046-0.895-2-2-2h-9-9z",transform:"translate(0 1028.4)",fill:"#34495e"}),v().createElement("path",{d:"m4 5.125v1.125l3 1.75-3 1.75v1.125l5-2.875-5-2.875zm5 4.875v1h5v-1h-5z",transform:"translate(0 1028.4)",fill:"#1db100"}))),v().createElement(G.Tooltip,{id:"terminal-tooltip"})):null),H=({clusterStatus:e,uuid:t,startLoading:s,forceUpdate:n})=>{return v().createElement(v().Fragment,null,[g.RUNNING,g.PAUSED,g.INITIALIZING].includes(e)&&v().createElement("div",null,v().createElement("div",{className:"bodo-cluster-list-stop-restart","data-tooltip-id":"stop-cluster-tooltip","data-tooltip-content":"Stop Cluster",onClick:(a=t,async()=>{if(!confirm("Are you sure that you want to stop this cluster?"))return!1;s(g.STOPPING),await async function(e){try{await l(`bodo/cluster/${e}/stop`,{method:"Put"})}catch(e){throw new Error(e)}}(a),n()})},v().createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"1em",viewBox:"0 0 384 512",id:"stop-svg"},v().createElement("path",{d:"M0 128C0 92.7 28.7 64 64 64H320c35.3 0 64 28.7 64 64V384c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V128z"})),v().createElement(G.Tooltip,{id:"stop-cluster-tooltip"}))),[g.STOPPED].includes(e)&&v().createElement("div",{className:"bodo-cluster-list-stop-restart","data-tooltip-id":"restart-cluster-tooltip","data-tooltip-content":"Restart Cluster",onClick:(e=>async()=>{if(!confirm("Are you sure that you want to restart this cluster"))return!1;s(g.INPROGRESS),await async function(e){try{await l(`bodo/cluster/${e}/restart`,{method:"Put"})}catch(e){throw new Error(e)}}(e),n()})(t)},v().createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"1em",viewBox:"0 0 512 512"},v().createElement("path",{d:"M463.5 224H472c13.3 0 24-10.7 24-24V72c0-9.7-5.8-18.5-14.8-22.2s-19.3-1.7-26.2 5.2L413.4 96.6c-87.6-86.5-228.7-86.2-315.8 1c-87.5 87.5-87.5 229.3 0 316.8s229.3 87.5 316.8 0c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0c-62.5 62.5-163.8 62.5-226.3 0s-62.5-163.8 0-226.3c62.2-62.2 162.7-62.5 225.3-1L327 183c-6.9 6.9-8.9 17.2-5.2 26.2s12.5 14.8 22.2 14.8H463.5z"})),v().createElement(G.Tooltip,{id:"restart-cluster-tooltip"})));var a};function V(e){const{cluster:t,forceUpdate:s,app:n}=e,[a,r]=E.useState(""),o=e=>{r(e),setTimeout((()=>{r("")}),5e3)};return E.createElement("li",{className:"bodo-ClusterListingItem","data-cluster-id":t.uuid,key:t.uuid},E.createElement("div",{className:"bodo-ClusterListingItem-title"},t.name),E.createElement("div",null,t.uuid),E.createElement("div",{className:"bodo-ClusterListingItem-stats"},E.createElement("span",{className:"bodo-ClusterListingItem-stats-name"},"Instances:")," ",t.workersQuantity),E.createElement("div",{className:"bodo-ClusterListingItem-stats"},E.createElement("span",{className:"bodo-ClusterListingItem-stats-name"},"Instance Type:")," ",t.instanceType),E.createElement("div",{className:"bodo-ClusterListingItem-stats"},E.createElement("span",{className:"bodo-ClusterListingItem-stats-name"},"Bodo Version:")," ",t.bodoVersion),E.createElement("div",{className:"bodo-ClusterListingItem-status-and-buttons"},E.createElement("div",{className:"bodo-ClusterListingItem-stats"},E.createElement("span",{className:"bodo-ClusterListingItem-stats-name"},"Status:")," ",E.createElement(j,{status:a||t.status})),E.createElement("div",{className:"bodo-ClusterListingItem-buttons"},[g.INPROGRESS,g.PAUSING,g.RESUMING,g.STOPPING,g.TERMINATING].includes(t.status)?E.createElement("span",null,E.createElement(C.Grid,{ariaLabel:"loading-indicator",width:10,height:10})):E.createElement(E.Fragment,null,E.createElement(q,{app:n,cluster:t}),E.createElement(F,{forceUpdate:()=>s(),startLoading:o,uuid:t.uuid,clusterStatus:t.status}),E.createElement(H,{clusterStatus:t.status,uuid:t.uuid,startLoading:o,forceUpdate:()=>s()})))))}function B(e){return E.createElement("li",{className:"bodo-ClusterListingItem"},E.createElement("div",{className:"bodo-ClusterListingItem-title"},"No Clusters"))}class W extends E.Component{constructor(e){super(e),this.state={clusters:e.store.clusters},this._app=e.app}componentDidMount(){this.props.store.clusterChaged.connect(this._onClusterUpdate,this)}componentWillUnmount(){this.props.store.clusterChaged.disconnect(this._onClusterUpdate,this)}async forceUpdate(){await this.props.store.forceUpdate()}_onClusterUpdate(e,t){let s;s=t.newValue?t.newValue:[],this.setState({clusters:s})}render(){const{clusters:e}=this.state;let t;const s=e.filter((e=>e.status!==g.NEW)).sort(S);return t=e.length>0?s.map((e=>E.createElement(V,{forceUpdate:()=>this.forceUpdate(),cluster:e,app:this._app}))):E.createElement(B,null),E.createElement("div",{className:"bodo-ClusterManager"},E.createElement("div",{className:"bodo-ClusterListing"},E.createElement("h2",null,"Bodo Clusters"),E.createElement("ul",{className:"bodo-ClusterListing-list"},t)),0!==e.filter((e=>e.status===g.INITIALIZING)).length?E.createElement("div",{className:"bodo-ClusterListing-warning"},"*Connecting to an initializing cluster is not recommended and for debugging purposes only"):null)}}class z extends h.ReactWidget{constructor(e,t){super(),this.addClass("bodo-Sidebar"),this._store=e,this._app=t}render(){return E.createElement(W,{store:this._store,app:this._app})}}var $=s(3697),Q=s(499),K=s(9782),Y=s(6201),J=s(2106),Z=s(8918),X=s(8832),ee=s(1502),te=s(1526);const se="api/terminals";async function ne(e=i.ServerConnection.makeSettings(),t,s,n){oe.errorIfNotAvailable();const a=o.URLExt.join(e.baseUrl,se),r={method:"POST",body:JSON.stringify({name:t,cwd:s,cluster:n})},l=await i.ServerConnection.makeRequest(a,r,e);if(200!==l.status)throw await i.ServerConnection.ResponseError.create(l);return await l.json()}async function ae(e=i.ServerConnection.makeSettings()){oe.errorIfNotAvailable();const t=o.URLExt.join(e.baseUrl,se),s=await i.ServerConnection.makeRequest(t,{},e);if(200!==s.status)throw await i.ServerConnection.ResponseError.create(s);const n=await s.json();if(!Array.isArray(n))throw new Error("Invalid terminal list");return n}async function re(e,t=i.ServerConnection.makeSettings()){var s;oe.errorIfNotAvailable();const n=o.URLExt.join(t.baseUrl,se,e),a=await i.ServerConnection.makeRequest(n,{method:"DELETE"},t);if(404===a.status){const t=null!==(s=(await a.json()).message)&&void 0!==s?s:`The terminal session "${e}"" does not exist on the server`;console.warn(t)}else if(204!==a.status)throw await i.ServerConnection.ResponseError.create(a)}var oe,ie,le;!function(e){e.errorIfNotAvailable=function(){if("true"!==String(o.PageConfig.getOption("terminalsAvailable")).toLowerCase())throw new Error("Terminals Unavailable")}}(oe||(oe={}));class ce{constructor(e){var t;this._createSocket=()=>{this._errorIfDisposed(),this._clearSocket(),this._updateConnectionStatus("connecting");const e=this._name,t=this.serverSettings;let s=o.URLExt.join(t.wsUrl,"terminals","websocket",encodeURIComponent(e));const n=t.token;t.appendToken&&""!==n&&(s+=`?token=${encodeURIComponent(n)}`),this._ws=new t.WebSocket(s),this._ws.onmessage=this._onWSMessage,this._ws.onclose=this._onWSClose,this._ws.onerror=this._onWSClose},this._onWSMessage=e=>{if(this._isDisposed)return;const t=JSON.parse(e.data);"disconnect"===t[0]&&this.dispose(),"connecting"!==this._connectionStatus?this._messageReceived.emit({type:t[0],content:t.slice(1)}):"setup"===t[0]&&this._updateConnectionStatus("connected")},this._onWSClose=e=>{console.warn(`Terminal websocket closed: ${e.code}`),this.isDisposed||this._reconnect()},this._connectionStatus="connecting",this._connectionStatusChanged=new r.Signal(this),this._isDisposed=!1,this._disposed=new r.Signal(this),this._messageReceived=new r.Signal(this),this._reconnectTimeout=null,this._ws=null,this._noOp=()=>{},this._reconnectLimit=7,this._reconnectAttempt=0,this._pendingMessages=[],this._name=e.model.name,this.serverSettings=null!==(t=e.serverSettings)&&void 0!==t?t:i.ServerConnection.makeSettings(),this._createSocket()}get disposed(){return this._disposed}get messageReceived(){return this._messageReceived}get name(){return this._name}get model(){return{name:this._name}}get isDisposed(){return this._isDisposed}dispose(){this._isDisposed||(this._isDisposed=!0,this._disposed.emit(),this._updateConnectionStatus("disconnected"),this._clearSocket(),r.Signal.clearData(this))}send(e){this._sendMessage(e)}_sendMessage(e,t=!0){if(!this._isDisposed&&e.content)if("connected"===this.connectionStatus&&this._ws){const t=[e.type,...e.content];this._ws.send(JSON.stringify(t))}else{if(!t)throw new Error(`Could not send message: ${JSON.stringify(e)}`);this._pendingMessages.push(e)}}_sendPending(){for(;"connected"===this.connectionStatus&&this._pendingMessages.length>0;)this._sendMessage(this._pendingMessages[0],!1),this._pendingMessages.shift()}reconnect(){this._errorIfDisposed();const e=new te.PromiseDelegate,t=(s,n)=>{"connected"===n?(e.resolve(),this.connectionStatusChanged.disconnect(t,this)):"disconnected"===n&&(e.reject(new Error("Terminal connection disconnected")),this.connectionStatusChanged.disconnect(t,this))};return this.connectionStatusChanged.connect(t,this),this._reconnectAttempt=0,this._reconnect(),e.promise}_reconnect(){if(this._errorIfDisposed(),clearTimeout(this._reconnectTimeout),this._reconnectAttempt<this._reconnectLimit){this._updateConnectionStatus("connecting");const e=ie.getRandomIntInclusive(0,1e3*(Math.pow(2,this._reconnectAttempt)-1));console.error(`Connection lost, reconnecting in ${Math.floor(e/1e3)} seconds.`),this._reconnectTimeout=setTimeout(this._createSocket,e),this._reconnectAttempt+=1}else this._updateConnectionStatus("disconnected");this._clearSocket()}_clearSocket(){null!==this._ws&&(this._ws.onopen=this._noOp,this._ws.onclose=this._noOp,this._ws.onerror=this._noOp,this._ws.onmessage=this._noOp,this._ws.close(),this._ws=null)}async shutdown(){await re(this.name,this.serverSettings),this.dispose()}clone(){return new ce(this)}_updateConnectionStatus(e){this._connectionStatus!==e&&(this._connectionStatus=e,"connecting"!==e&&(this._reconnectAttempt=0,clearTimeout(this._reconnectTimeout)),"connected"===e&&this._sendPending(),this._connectionStatusChanged.emit(e))}_errorIfDisposed(){if(this.isDisposed)throw new Error("Terminal connection is disposed")}get connectionStatusChanged(){return this._connectionStatusChanged}get connectionStatus(){return this._connectionStatus}}!function(e){e.getTermUrl=function(e,t){return o.URLExt.join(e,se,encodeURIComponent(t))},e.getRandomIntInclusive=function(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}}(ie||(ie={}));class de{constructor(e){var t;this._isDisposed=!1,this._disposed=new r.Signal(this),this.serverSettings=null!==(t=e.serverSettings)&&void 0!==t?t:i.ServerConnection.makeSettings()}get disposed(){return this._disposed}get isDisposed(){return this._isDisposed}get isActive(){return!0}dispose(){this.isDisposed||(this._disposed.emit(void 0),r.Signal.clearData(this))}}class ue extends de{constructor(e={}){var t;super(e),this._isReady=!1,this._names=[],this._connections=new Set,this._runningChanged=new r.Signal(this),this._connectionFailure=new r.Signal(this),this._pollModels=new a.Poll({auto:!1,factory:()=>this.requestRunning(),frequency:{interval:1e4,backoff:!0,max:3e5},name:"@jupyterlab/services:TerminalManager#models",standby:null!==(t=e.standby)&&void 0!==t?t:"when-hidden"}),this._ready=(async()=>{await this._pollModels.start(),await this._pollModels.tick,this._isReady=!0})()}isAvailable(){return!0}get isReady(){return this._isReady}get ready(){return this._ready}get runningChanged(){return this._runningChanged}get connectionFailure(){return this._connectionFailure}dispose(){this.isDisposed||(this._names.length=0,this._connections.forEach((e=>e.dispose())),this._pollModels.dispose(),super.dispose())}connectTo(e){const t=new ce(Object.assign(Object.assign({},e),{serverSettings:this.serverSettings}));return this._onStarted(t),this._names.includes(e.model.name)||this.refreshRunning().catch((()=>{})),t}running(){return(0,Z.iter)(this._models)}async refreshRunning(){await this._pollModels.refresh(),await this._pollModels.tick}async startNew(e){const t=await ne(this.serverSettings,null==e?void 0:e.name,null==e?void 0:e.cwd);return await this.refreshRunning(),this.connectTo({model:t})}async startNewClusterTeminal(e,t){const s=await ne(this.serverSettings,null==e?void 0:e.name,null==e?void 0:e.cwd,t);return await this.refreshRunning(),this.connectTo({model:s})}async shutdown(e){await re(e,this.serverSettings),await this.refreshRunning()}async shutdownAll(){await this.refreshRunning(),await Promise.all(this._names.map((e=>re(e,this.serverSettings)))),await this.refreshRunning()}async requestRunning(){var e,t;let s;try{s=await ae(this.serverSettings)}catch(s){throw(s instanceof i.ServerConnection.NetworkError||503===(null===(e=s.response)||void 0===e?void 0:e.status)||424===(null===(t=s.response)||void 0===t?void 0:t.status))&&this._connectionFailure.emit(s),s}if(this.isDisposed)return;const n=s.map((({name:e})=>e)).sort();n!==this._names&&(this._names=n,this._connections.forEach((e=>{n.includes(e.name)||e.dispose()})),this._runningChanged.emit(this._models))}_onStarted(e){this._connections.add(e),e.disposed.connect(this._onDisposed,this)}_onDisposed(e){this._connections.delete(e),this.refreshRunning().catch((()=>{}))}get _models(){return this._names.map((e=>({name:e})))}}!function(e){e.NoopManager=class extends e{constructor(){super(...arguments),this._ReadyPromise=new Promise((()=>{}))}get isActive(){return!1}get parentReady(){return super.ready}get ready(){return this.parentReady.then((()=>this._ReadyPromise))}async startNew(e){return Promise.reject(new Error("Not implemented in no-op Terminal Manager"))}connectTo(e){throw Error("Not implemented in no-op Terminal Manager")}async shutdown(e){return Promise.reject(new Error("Not implemented in no-op Terminal Manager"))}async requestRunning(){return Promise.resolve()}}}(ue||(ue={})),function(e){e.createNew="terminal:create-new",e.open="terminal:open",e.refresh="terminal:refresh",e.increaseFont="terminal:increase-font",e.decreaseFont="terminal:decrease-font",e.setTheme="terminal:set-theme",e.shutdown="terminal:shut-down"}(le||(le={}));const he={activate:async function(e,t,s,n,a,r,o,i,l){const c=s.load("jupyterlab"),{commands:d}=e,m=c.__("Terminal"),g=new h.WidgetTracker({namespace:"Terminal"});r&&r.restore(g,{command:le.createNew,args:e=>({name:e.content.session.name}),name:e=>e.content.session.name});const p={};function w(e){Object.keys(e.composite).forEach((t=>{p[t]=e.composite[t]}))}function _(){g.forEach((e=>function(e){const t=e.content;t&&Object.keys(p).forEach((e=>{t.setOption(e,p[e])}))}(e)))}t.load(he.id).then((e=>{w(e),_(),e.changed.connect((()=>{w(e),_()}))})).catch(me.showErrorMessage),null==i||i.themeChanged.connect(((e,t)=>{g.forEach((e=>{const t=e.content;"inherit"===t.getOption("theme")&&t.setOption("theme","inherit")}))}));const E=new ue;!function(e,t,s,n,a,r){const o=a.load("jupyterlab"),{commands:i}=e;i.addCommand(le.createNew,{label:e=>e.isPalette?o.__("New Terminal"):o.__("Terminal"),caption:o.__("Start a new cluster terminal session"),icon:e=>e.isPalette?void 0:O.terminalIcon,execute:async n=>{let o;try{o=(await me.ensureWidget()).Terminal}catch(e){return void me.showErrorMessage(e)}const i=n.name,l=n.cwd,c=n.cluster;let d,u;u=c?t.startNewClusterTeminal.bind(t,{name:i,cwd:l},c):t.startNew.bind(t,{name:i,cwd:l}),i?d=(await ae()).map((e=>e.name)).includes(i)?t.connectTo({model:{name:i}}):await u():(d=await u(),console.log(`Session: ${d}`));const m=new o(d,r,a);m.title.icon=O.terminalIcon,m.title.label="...";const g=new h.MainAreaWidget({content:m});return e.shell.add(g),s.add(g),e.shell.activateById(g.id),g}}),i.addCommand(le.open,{label:o.__("Open a terminal by its `name`."),execute:t=>{const n=t.name,a=s.find((e=>e.content.session.name===n||!1));if(!a)return i.execute(le.createNew,{name:n});e.shell.activateById(a.id)}}),i.addCommand(le.refresh,{label:o.__("Refresh Terminal"),caption:o.__("Refresh the current terminal session"),execute:async()=>{const t=s.currentWidget;if(t){e.shell.activateById(t.id);try{await t.content.refresh(),t&&t.content.activate()}catch(e){me.showErrorMessage(e)}}},isEnabled:()=>null!==s.currentWidget}),i.addCommand(le.shutdown,{label:o.__("Shutdown Terminal"),execute:()=>{const e=s.currentWidget;if(e)return e.content.session.shutdown()},isEnabled:()=>null!==s.currentWidget}),i.addCommand(le.increaseFont,{label:o.__("Increase Terminal Font Size"),execute:async()=>{const{fontSize:e}=r;if(e&&e<72)try{await n.set(he.id,"fontSize",e+1)}catch(e){me.showErrorMessage(e)}}}),i.addCommand(le.decreaseFont,{label:o.__("Decrease Terminal Font Size"),execute:async()=>{const{fontSize:e}=r;if(e&&e>9)try{await n.set(he.id,"fontSize",e-1)}catch(e){me.showErrorMessage(e)}}});const l={inherit:o.__("Inherit"),light:o.__("Light"),dark:o.__("Dark")};i.addCommand(le.setTheme,{label:e=>{if(void 0===e.theme)return o.__("Set terminal theme to the provided `theme`.");const t=e.theme,s=t in l?l[t]:o.__(t[0].toUpperCase()+t.slice(1));return e.isPalette?o.__("Use Terminal Theme: %1",s):s},caption:o.__("Set the terminal theme"),isToggled:e=>{const{theme:t}=r;return e.theme===t},execute:async e=>{const t=e.theme;try{await n.set(he.id,"theme",t),i.notifyCommandChanged(le.setTheme)}catch(e){console.log(e),me.showErrorMessage(e)}}})}(e,E,g,t,s,p);const v=(await u()).allowLocalExecution;if(o&&v){const e=new X.Menu({commands:d});e.title.label=c._p("menu","Terminal Theme"),e.addItem({command:le.setTheme,args:{theme:"inherit",displayName:c.__("Inherit"),isPalette:!1}}),e.addItem({command:le.setTheme,args:{theme:"light",displayName:c.__("Light"),isPalette:!1}}),e.addItem({command:le.setTheme,args:{theme:"dark",displayName:c.__("Dark"),isPalette:!1}}),o.settingsMenu.addGroup([{command:le.increaseFont},{command:le.decreaseFont},{type:"submenu",submenu:e}],40),o.fileMenu.newMenu.addItem({command:le.createNew,rank:20}),o.fileMenu.closeAndCleaners.add({tracker:g,closeAndCleanupLabel:e=>c.__("Shutdown Terminal"),closeAndCleanup:e=>e.content.session.shutdown()})}return n&&v&&([le.createNew,le.refresh,le.increaseFont,le.decreaseFont].forEach((e=>{n.addItem({command:e,category:m,args:{isPalette:!0}})})),n.addItem({command:le.setTheme,category:m,args:{theme:"inherit",displayName:c.__("Inherit"),isPalette:!0}}),n.addItem({command:le.setTheme,category:m,args:{theme:"light",displayName:c.__("Light"),isPalette:!0}}),n.addItem({command:le.setTheme,category:m,args:{theme:"dark",displayName:c.__("Dark"),isPalette:!0}})),a&&v&&a.add({command:le.createNew,category:c.__("Other"),rank:0}),l&&function(e,t,s,n){const a=s.load("jupyterlab");e.add({name:a.__("Terminals"),running:()=>(0,Z.toArray)(n.running()).map((e=>new r(e))),shutdownAll:()=>n.shutdownAll(),refreshRunning:()=>n.refreshRunning(),runningChanged:n.runningChanged,shutdownLabel:a.__("Shut Down"),shutdownAllLabel:a.__("Shut Down All"),shutdownAllConfirmationText:a.__("Are you sure you want to permanently shut down all running terminals?")});class r{constructor(e){this._model=e}open(){t.commands.execute("terminal:open",{name:this._model.name})}icon(){return O.terminalIcon}label(){return`terminals/${this._model.name}`}shutdown(){return n.shutdown(this._model.name)}}}(l,e,s,E),g},id:"bodoterminal-extension:plugin",provides:J.ITerminalTracker,requires:[Y.ISettingRegistry,ee.ITranslator],optional:[h.ICommandPalette,$.ILauncher,n.ILayoutRestorer,Q.IMainMenu,h.IThemeManager,K.IRunningSessionManagers],autoStart:!0};var me,ge;!function(e){e.ensureWidget=function(){return e.widgetReady||(e.widgetReady=Promise.all([s.e(27),s.e(773)]).then(s.bind(s,27))),e.widgetReady},e.showErrorMessage=function(e){console.error(`Failed to configure ${he.id}: ${e.message}`)}}(me||(me={})),function(e){e.loadState="apputils:load-statedb",e.print="apputils:print",e.reset="apputils:reset",e.resetOnLoad="apputils:reset-on-load",e.runFirstEnabled="apputils:run-first-enabled",e.runAllEnabled="apputils:run-all-enabled",e.toggleHeader="apputils:toggle-header",e.displayShortcuts="apputils:display-shortcuts"}(ge||(ge={}));const pe={id:"@jupyterlab/apputils-extension:bodosplash",autoStart:!0,requires:[ee.ITranslator],provides:h.ISplashScreen,activate:(e,t)=>{const s=t.load("jupyterlab"),{commands:n,restored:r}=e,o=document.createElement("div"),i=document.createElement("div"),c=document.createElement("div");let d;o.id="jupyterlab-splash",i.id="galaxy",c.id="main-logo",new O.LabIcon({name:"bodo_jupyterlab:logo-bg",svgstr:'<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" width="1081" height="1081" viewBox="0 0 1081 1081"><defs><style>.cls-1{fill:#1db100;}</style></defs><title>Bodo-Platform</title><path class="cls-1" d="M541,427.5a239.62,239.62,0,0,1,95,19.12A247.7,247.7,0,0,1,767.64,578.23a239.79,239.79,0,0,1,19.11,95q0,51.35-19.11,95.57A249.19,249.19,0,0,1,636,899.88,239.45,239.45,0,0,1,541,919q-51.35,0-95.57-19.12A250.7,250.7,0,0,1,314.36,768.82q-19.11-44.24-19.11-95.57V193.77q0-14.19,9.83-23.48A32.4,32.4,0,0,1,328,161a30.57,30.57,0,0,1,22.39,9.29q9.25,9.28,9.28,23.48V508.33q30.57-32.77,66.63-51.34A247,247,0,0,1,482,435.15a234.51,234.51,0,0,1,59-7.65m0,427.06a177.8,177.8,0,0,0,70.45-14.2,181,181,0,0,0,96.66-96.11q14.17-32.78,14.2-71a178.15,178.15,0,0,0-14.2-70.45,179.61,179.61,0,0,0-96.66-96.66,181.86,181.86,0,0,0-140.9,0,179.61,179.61,0,0,0-96.66,96.66,177.8,177.8,0,0,0-14.2,70.45q0,38.25,14.2,71a183.42,183.42,0,0,0,38.77,57.34,181.58,181.58,0,0,0,57.89,38.77A177.7,177.7,0,0,0,541,854.56"/></svg>'}).element({container:c,stylesheet:"splash"}),i.appendChild(c),["1","2","3"].forEach((e=>{const t=document.createElement("div"),s=document.createElement("div");t.id=`moon${e}`,t.className="moon orbit",s.id=`planet${e}`,s.className="planet",t.appendChild(s),i.appendChild(t)})),o.appendChild(i);const u=new a.Throttler((async()=>{if(!d){d=new h.Dialog({title:s.__("Loading…"),body:s.__("The loading screen is taking a long time.\nWould you like to clear the workspace or keep waiting?"),buttons:[h.Dialog.cancelButton({label:s.__("Keep Waiting")}),h.Dialog.warnButton({label:s.__("Clear Workspace")})]});try{const e=await d.launch();if(d.dispose(),d=null,e.button.accept&&n.hasCommand(ge.reset))return n.execute(ge.reset);requestAnimationFrame((()=>{u.invoke().catch((e=>{}))}))}catch(e){}}}),{limit:12e3,edge:"trailing"});let m=0;setInterval((async()=>{await async function(){console.log("Check kernels activity!"+(new Date).getTime());try{await l("bodo/kernels_activity",{method:"POST"})}catch(e){throw new Error(e)}}()}),3e4);let g=null;function p(){null!==g&&(clearInterval(g),g=null)}function w(){g=setInterval((async()=>{await async function(){await async function(){console.log("Set jupyter activity"+(new Date).getTime());try{await l("bodo/activity",{method:"POST"})}catch(e){throw new Error(e)}}()}()}),3e4)}return window.addEventListener("focus",w),window.addEventListener("blur",(function(){p()})),w(),window.addEventListener("beforeunload",p),{show:(e=!0)=>(o.classList.remove("splash-fade"),o.classList.toggle("light",e),o.classList.toggle("dark",!e),m++,document.body.appendChild(o),u.invoke().catch((e=>{})),new _.DisposableDelegate((async()=>{await r,0==--m&&(u.stop(),d&&(d.dispose(),d=null),o.classList.add("splash-fade"),window.setTimeout((()=>{document.body.removeChild(o)}),200))})))}}},we=[{id:"bodo-labextension:plugin",autoStart:!0,requires:[n.ILabShell],activate:(e,t)=>{console.log("Bodo JupyterLab extension activated!");const s=new O.LabIcon({name:"cluster_icon",svgstr:'<svg xmlns="http://www.w3.org/2000/svg"\n     viewBox="0 0 576 512">\x3c!-- Font Awesome Pro 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) --\x3e\n    <path d="M560 288h-80v96l-32-21.3-32 21.3v-96h-80c-8.8 0-16 7.2-16 16v192c0 8.8 7.2 16 16 16h224c8.8 0 16-7.2 16-16V304c0-8.8-7.2-16-16-16zm-384-64h224c8.8 0 16-7.2 16-16V16c0-8.8-7.2-16-16-16h-80v96l-32-21.3L256 96V0h-80c-8.8 0-16 7.2-16 16v192c0 8.8 7.2 16 16 16zm64 64h-80v96l-32-21.3L96 384v-96H16c-8.8 0-16 7.2-16 16v192c0 8.8 7.2 16 16 16h224c8.8 0 16-7.2 16-16V304c0-8.8-7.2-16-16-16z"\n          fill="#616161"\n    />\n\n</svg>\n'}),n=new O.LabIcon({name:"bodo_jupyterlab:logo-bg",svgstr:'<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" width="1081" height="1081" viewBox="0 0 1081 1081"><defs><style>.cls-1{fill:#1db100;}.cls-2{fill:#fff;}</style></defs><title>bodo-icon-white-bg</title><rect class="cls-1" width="1081" height="1081"/><path class="cls-2" d="M541,427.5a239.62,239.62,0,0,1,95,19.12A247.7,247.7,0,0,1,767.64,578.23a239.79,239.79,0,0,1,19.11,95q0,51.35-19.11,95.57A249.19,249.19,0,0,1,636,899.88,239.45,239.45,0,0,1,541,919q-51.35,0-95.57-19.12A250.7,250.7,0,0,1,314.36,768.82q-19.11-44.24-19.11-95.57V193.77q0-14.19,9.83-23.48A32.4,32.4,0,0,1,328,161a30.57,30.57,0,0,1,22.39,9.29q9.25,9.28,9.28,23.48V508.33q30.57-32.77,66.63-51.34A247,247,0,0,1,482,435.15a234.51,234.51,0,0,1,59-7.65m0,427.06a177.8,177.8,0,0,0,70.45-14.2,181,181,0,0,0,96.66-96.11q14.17-32.78,14.2-71a178.15,178.15,0,0,0-14.2-70.45,179.61,179.61,0,0,0-96.66-96.66,181.86,181.86,0,0,0-140.9,0,179.61,179.61,0,0,0-96.66,96.66,177.8,177.8,0,0,0-14.2,70.45q0,38.25,14.2,71a183.42,183.42,0,0,0,38.77,57.34,181.58,181.58,0,0,0,57.89,38.77A177.7,177.7,0,0,0,541,854.56"/></svg>'}),a=e.shell.widgets("top");let r=a.next();for(;void 0!==r;){if("jp-MainLogo"===r.id){n.element({container:r.node,justify:"center",margin:"2px 5px 2px 5px",height:"auto",width:"20px"});break}r=a.next(),console.log("widget",r)}const o=new m;e.docRegistry.addWidgetExtension("Notebook",new A(o,null));const i=new z(o,e);i.id="bodo-cluster-list",i.title.icon=s,i.title.caption="Bodo Clusters",t.add(i,"left",{rank:200})}},he,pe,k]}}]);