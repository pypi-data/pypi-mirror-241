image: python:3.8

before_script:
  - apt-get update && apt-get install git

pages:
  script:
  - pip install -U pip
  - pip install -U sphinx sphinx_rtd_theme numpydoc
  - pip install -ve .
  - sphinx-build -b html docs/source public
  artifacts:
    paths:
    - public
  only:
  - main

pypi:
  script:
    - pip install build twine
    - python -m build
    - TWINE_PASSWORD=${TWINE_PASSWORD} TWINE_USERNAME=${TWINE_USERNAME} python -m twine upload dist/*
  only:
    - tags
