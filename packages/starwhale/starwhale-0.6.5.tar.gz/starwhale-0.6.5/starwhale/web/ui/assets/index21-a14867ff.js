import{S as $,i as x,s as Y,B as At,d as j,m as B,n as w,o as A,q as T,y as It,X as yt,z as he,A as Ct,C as zt,c as L,D as oe,h as I,E as Mt,F as jt,G as V,H as G,p as y,I as ce,K as E,Q as J,R as Q,e as U,f as d,ae as Ye,g as q,ai as bt,a9 as Se,L as X,j as S,M as N,N as O,l as P,ac as kt,U as Bt,J as Tt,t as be,k as Qe,aj as Ze,ad as Xe,ak as St,P as pt,a8 as Re,al as Rt,am as $e}from"./routes-7e4fc71d.js";import{B as wt}from"./BlockLabel-67cbdf2f.js";import{I as De}from"./Image2-3e506e66.js";import{W as Dt,C as Et,i as Lt,U as Ut}from"./Webcam-663e7a26.js";import{M as Le,I as Ee,C as Nt}from"./ModifyUpload-d2a632b7.js";import{U as Ft}from"./Upload-bdd10ef8.js";import{E as Wn}from"./Image-70d541e4.js";import"./index-ebb97cb7.js";import"./useReport-3eabe4cc.js";function qt(t){let e,n,i;return{c(){e=X("svg"),n=X("path"),i=X("path"),d(n,"d","M28.828 3.172a4.094 4.094 0 0 0-5.656 0L4.05 22.292A6.954 6.954 0 0 0 2 27.242V30h2.756a6.952 6.952 0 0 0 4.95-2.05L28.828 8.829a3.999 3.999 0 0 0 0-5.657zM10.91 18.26l2.829 2.829l-2.122 2.121l-2.828-2.828zm-2.619 8.276A4.966 4.966 0 0 1 4.756 28H4v-.759a4.967 4.967 0 0 1 1.464-3.535l1.91-1.91l2.829 2.828zM27.415 7.414l-12.261 12.26l-2.829-2.828l12.262-12.26a2.047 2.047 0 0 1 2.828 0a2 2 0 0 1 0 2.828z"),d(n,"fill","currentColor"),d(i,"d","M6.5 15a3.5 3.5 0 0 1-2.475-5.974l3.5-3.5a1.502 1.502 0 0 0 0-2.121a1.537 1.537 0 0 0-2.121 0L3.415 5.394L2 3.98l1.99-1.988a3.585 3.585 0 0 1 4.95 0a3.504 3.504 0 0 1 0 4.949L5.439 10.44a1.502 1.502 0 0 0 0 2.121a1.537 1.537 0 0 0 2.122 0l4.024-4.024L13 9.95l-4.025 4.024A3.475 3.475 0 0 1 6.5 15z"),d(i,"fill","currentColor"),d(e,"width","100%"),d(e,"height","100%"),d(e,"viewBox","0 0 32 32")},m(l,r){I(l,e,r),S(e,n),S(e,i)},p:N,i:N,o:N,d(l){l&&y(e)}}}class Ot extends ${constructor(e){super(),x(this,e,null,qt,Y,{})}}function Pt(t){let e,n,i,l,r,s,u;return{c(){e=X("svg"),n=X("circle"),i=X("circle"),l=X("circle"),r=X("circle"),s=X("circle"),u=X("path"),d(n,"cx","10"),d(n,"cy","12"),d(n,"r","2"),d(n,"fill","currentColor"),d(i,"cx","16"),d(i,"cy","9"),d(i,"r","2"),d(i,"fill","currentColor"),d(l,"cx","22"),d(l,"cy","12"),d(l,"r","2"),d(l,"fill","currentColor"),d(r,"cx","23"),d(r,"cy","18"),d(r,"r","2"),d(r,"fill","currentColor"),d(s,"cx","19"),d(s,"cy","23"),d(s,"r","2"),d(s,"fill","currentColor"),d(u,"fill","currentColor"),d(u,"d","M16.54 2A14 14 0 0 0 2 16a4.82 4.82 0 0 0 6.09 4.65l1.12-.31a3 3 0 0 1 3.79 2.9V27a3 3 0 0 0 3 3a14 14 0 0 0 14-14.54A14.05 14.05 0 0 0 16.54 2Zm8.11 22.31A11.93 11.93 0 0 1 16 28a1 1 0 0 1-1-1v-3.76a5 5 0 0 0-5-5a5.07 5.07 0 0 0-1.33.18l-1.12.31A2.82 2.82 0 0 1 4 16A12 12 0 0 1 16.47 4A12.18 12.18 0 0 1 28 15.53a11.89 11.89 0 0 1-3.35 8.79Z"),d(e,"width","100%"),d(e,"height","100%"),d(e,"viewBox","0 0 32 32")},m(o,g){I(o,e,g),S(e,n),S(e,i),S(e,l),S(e,r),S(e,s),S(e,u)},p:N,i:N,o:N,d(o){o&&y(e)}}}class Wt extends ${constructor(e){super(),x(this,e,null,Pt,Y,{})}}function Ht(t){let e,n;return{c(){e=X("svg"),n=X("path"),d(n,"d","M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"width","100%"),d(e,"height","100%"),d(e,"viewBox","0 0 24 24"),d(e,"fill","none"),d(e,"stroke","currentColor"),d(e,"stroke-width","1.5"),d(e,"stroke-linecap","round"),d(e,"stroke-linejoin","round"),d(e,"class","feather feather-edit-2")},m(i,l){I(i,e,l),S(e,n)},p:N,i:N,o:N,d(i){i&&y(e)}}}class xe extends ${constructor(e){super(),x(this,e,null,Ht,Y,{})}}function Jt(t){let e,n;return{c(){e=U("img"),O(e.src,n=t[0])||d(e,"src",n),d(e,"alt","")},m(i,l){I(i,e,l),t[2](e)},p(i,[l]){l&1&&!O(e.src,n=i[0])&&d(e,"src",n)},i:N,o:N,d(i){i&&y(e),t[2](null)}}}function Qt(t,e,n){let{image:i}=e,l;const r=he();kt(()=>{const u=new Et(l,{autoCropArea:1,cropend(){const o=u.getCroppedCanvas().toDataURL();r("crop",o)}});return r("crop",i),()=>{u.destroy()}});function s(u){E[u?"unshift":"push"](()=>{l=u,n(1,l)})}return t.$$set=u=>{"image"in u&&n(0,i=u.image)},[i,l,s]}class vt extends ${constructor(e){super(),x(this,e,Qt,Jt,Y,{image:0})}}class et{constructor(e,n){this.x=e,this.y=n}}class tt extends et{update(e){this.x=e.x,this.y=e.y}moveByAngle(e,n){const i=e+Math.PI/2;this.x=this.x+Math.sin(i)*n,this.y=this.y-Math.cos(i)*n}equalsTo(e){return this.x===e.x&&this.y===e.y}getDifferenceTo(e){return new et(this.x-e.x,this.y-e.y)}getDistanceTo(e){const n=this.getDifferenceTo(e);return Math.sqrt(Math.pow(n.x,2)+Math.pow(n.y,2))}getAngleTo(e){const n=this.getDifferenceTo(e);return Math.atan2(n.y,n.x)}toObject(){return{x:this.x,y:this.y}}}const Xt=30;class Yt{constructor({radius:e=Xt,enabled:n=!0,initialPoint:i={x:0,y:0}}={}){this.radius=e,this._isEnabled=n,this.pointer=new tt(i.x,i.y),this.brush=new tt(i.x,i.y),this.angle=0,this.distance=0,this._hasMoved=!1}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}isEnabled(){return this._isEnabled}setRadius(e){this.radius=e}getRadius(){return this.radius}getBrushCoordinates(){return this.brush.toObject()}getPointerCoordinates(){return this.pointer.toObject()}getBrush(){return this.brush}getPointer(){return this.pointer}getAngle(){return this.angle}getDistance(){return this.distance}brushHasMoved(){return this._hasMoved}update(e,{both:n=!1}={}){return this._hasMoved=!1,this.pointer.equalsTo(e)&&!n?!1:(this.pointer.update(e),n?(this._hasMoved=!0,this.brush.update(e),!0):(this._isEnabled?(this.distance=this.pointer.getDistanceTo(this.brush),this.angle=this.pointer.getAngleTo(this.brush),this.distance>this.radius&&(this.brush.moveByAngle(this.angle,this.distance-this.radius),this._hasMoved=!0)):(this.distance=0,this.angle=0,this.brush.update(e),this._hasMoved=!0),!0))}}function nt(t,e,n){const i=t.slice();return i[56]=e[n].name,i[57]=e[n].zIndex,i[58]=e,i[59]=n,i}function it(t){let e,n,i;return{c(){e=U("div"),e.textContent="Start drawing",d(e,"class","absolute inset-0 flex items-center justify-center z-40 pointer-events-none touch-none text-gray-400 md:text-xl")},m(l,r){I(l,e,r),i=!0},i(l){i||(Ye(()=>{n||(n=Ze(e,$e,{duration:50},!0)),n.run(1)}),i=!0)},o(l){n||(n=Ze(e,$e,{duration:50},!1)),n.run(0),i=!1},d(l){l&&y(e),l&&n&&n.end()}}}function lt(t){let e,n=t[56],i,l;const r=()=>t[27](e,n),s=()=>t[27](null,n);return{c(){e=U("canvas"),d(e,"key",t[56]),d(e,"class","inset-0 m-auto hover:cursor-none"),Xe(e,"display","block"),Xe(e,"position","absolute"),Xe(e,"z-index",t[57])},m(u,o){I(u,e,o),r(),i||(l=[P(e,"mousedown",t[56]==="interface"?t[6]:void 0),P(e,"mousemove",t[56]==="interface"?t[7]:void 0),P(e,"mouseup",t[56]==="interface"?t[8]:void 0),P(e,"mouseout",t[56]==="interface"?t[8]:void 0),P(e,"blur",t[56]==="interface"?t[8]:void 0),P(e,"touchstart",t[56]==="interface"?t[6]:void 0),P(e,"touchmove",t[56]==="interface"?t[7]:void 0),P(e,"touchend",t[56]==="interface"?t[8]:void 0),P(e,"touchcancel",t[56]==="interface"?t[8]:void 0),P(e,"click",St(t[26]))],i=!0)},p(u,o){t=u,n!==t[56]&&(s(),n=t[56],r())},d(u){u&&y(e),s(),i=!1,pt(l)}}}function Vt(t){let e,n,i,l,r=t[4]===0&&it(),s=t[5],u=[];for(let o=0;o<s.length;o+=1)u[o]=lt(nt(t,s,o));return{c(){e=U("div"),r&&r.c(),n=L();for(let o=0;o<u.length;o+=1)u[o].c();d(e,"class","touch-none relative h-full w-full"),Ye(()=>t[29].call(e))},m(o,g){I(o,e,g),r&&r.m(e,null),S(e,n);for(let _=0;_<u.length;_+=1)u[_].m(e,null);t[28](e),i=bt(e,t[29].bind(e)),l=!0},p(o,g){if(o[4]===0?r?g[0]&16&&w(r,1):(r=it(),r.c(),w(r,1),r.m(e,n)):r&&(V(),A(r,1,1,()=>{r=null}),G()),g[0]&481){s=o[5];let _;for(_=0;_<s.length;_+=1){const m=nt(o,s,_);u[_]?u[_].p(m,g):(u[_]=lt(m),u[_].c(),u[_].m(e,null))}for(;_<u.length;_+=1)u[_].d(1);u.length=s.length}},i(o){l||(w(r),l=!0)},o(o){A(r),l=!1},d(o){o&&y(e),r&&r.d(),Bt(u,o),t[28](null),i()}}}let Gt="#aaa";function rt(t,e){return{x:t.x+(e.x-t.x)/2,y:t.y+(e.y-t.y)/2}}function Kt(t,e,n){let i;const l=he();let{value:r}=e,{value_img:s}=e,{mode:u="sketch"}=e,{brush_color:o="#0b0f19"}=e,{brush_radius:g=50}=e,{source:_}=e,{width:m=400}=e,{height:a=200}=e,{container_height:f=200}=e,p,v=m,D=a,ee;const ue=[{name:"interface",zIndex:15},{name:"drawing",zIndex:11},{name:"temp",zIndex:12},{name:"mask",zIndex:-1},{name:"temp_fake",zIndex:-2}];let M={},b={},W=[],H=[],te=!0,ne=!0,ie=!1,F=!1,k=null,K=null,ae=null,le=0;kt(async()=>{Object.keys(M).forEach(c=>{n(23,b[c]=M[c].getContext("2d"),b)}),await Se(),s&&(s.addEventListener("load",c=>{_==="webcam"?(b.temp.save(),b.temp.translate(m,0),b.temp.scale(-1,1),b.temp.drawImage(s,0,0),b.temp.restore()):b.temp.drawImage(s,0,0),b.drawing.drawImage(M.temp,0,0,m,a),se()}),setTimeout(()=>{_==="webcam"?(b.temp.save(),b.temp.translate(m,0),b.temp.scale(-1,1),b.temp.drawImage(s,0,0),b.temp.restore()):b.temp.drawImage(s,0,0),b.drawing.drawImage(M.temp,0,0,m,a),me({lines:H.slice()}),se()},100)),n(25,k=new Yt({radius:g*.05,enabled:!0,initialPoint:{x:m/2,y:a/2}})),ae=new Lt((c,C,...z)=>{Ae()}),ae.observe(K),ge(),n(21,p=!0),requestAnimationFrame(()=>{re(),requestAnimationFrame(()=>{_e()})})});function re(){const c=m/2,C=a/2;k.update({x:c,y:C},{both:!0}),k.update({x:c,y:C},{both:!1}),te=!0,ne=!0}Tt(()=>{n(21,p=!1),ae.unobserve(K)});function Ue(){const c=H.slice(0,-1);Be(),s&&(_==="webcam"?(b.temp.save(),b.temp.translate(m,0),b.temp.scale(-1,1),b.temp.drawImage(s,0,0),b.temp.restore()):b.temp.drawImage(s,0,0),(!H||!H.length)&&b.drawing.drawImage(M.temp,0,0,m,a)),me({lines:c}),n(4,le=c.length),H.length&&n(24,H=c),se()}let me=({lines:c})=>{c.forEach(C=>{const{points:z,brush_color:h,brush_radius:R}=C;Ce({points:z,brush_color:h,brush_radius:R}),u==="mask"&&ze({points:z,brush_color:h,brush_radius:R}),W=z}),je(),u==="mask"&&Me()},Ne=c=>{c.preventDefault(),F=!0;const{x:C,y:z}=Ie(c);c.touches&&c.touches.length>0&&k.update({x:C,y:z},{both:!0}),ye(C,z),n(4,le+=1)},ke=c=>{c.preventDefault();const{x:C,y:z}=Ie(c);ye(C,z)},Fe=c=>{c.preventDefault(),ke(c),ie=!1,F=!1,je(),u==="mask"&&Me()},pe=0,we=0,ve=0,Ae=async()=>{if(m===pe&&a===we&&ve===f)return;const c={width:m,height:a},C={height:f,width:f*(c.width/c.height)};await Promise.all([fe(M.interface,c,C),fe(M.drawing,c,C),fe(M.temp,c,C),fe(M.temp_fake,c,C),fe(M.mask,c,C,!1)]),n(9,g=20*(c.width/C.width)),ge({once:!0}),setTimeout(()=>{we=a,pe=m,ve=f},100),_e()},fe=async(c,C,z,h=!0)=>{if(!p)return;await Se();const R=window.devicePixelRatio||1;c.width=C.width*(h?R:1),c.height=C.height*(h?R:1);const Z=c.getContext("2d");h&&Z.scale(R,R),c.style.width=`${z.width}px`,c.style.height=`${z.height}px`},Ie=c=>{const C=M.interface.getBoundingClientRect();let z=c.clientX,h=c.clientY;return c.changedTouches&&c.changedTouches.length>0&&(z=c.changedTouches[0].clientX,h=c.changedTouches[0].clientY),{x:(z-C.left)/C.width*m,y:(h-C.top)/C.height*a}},ye=(c,C)=>{k.update({x:c,y:C});const z=!k.isEnabled();(F&&!ie||z&&F)&&(ie=!0,W.push(k.brush.toObject())),ie&&(W.push(k.brush.toObject()),Ce({points:W,brush_color:o,brush_radius:g}),u==="mask"&&ze({points:W,brush_color:o,brush_radius:g})),te=!0},Ce=({points:c,brush_color:C,brush_radius:z})=>{if(!c||c.length<2||(n(23,b.temp.lineJoin="round",b),n(23,b.temp.lineCap="round",b),n(23,b.temp.strokeStyle=C,b),n(23,b.temp.lineWidth=z,b),!c||c.length<2))return;let h=c[0],R=c[1];b.temp.moveTo(R.x,R.y),b.temp.beginPath();for(var Z=1,Je=c.length;Z<Je;Z++){var de=rt(h,R);b.temp.quadraticCurveTo(h.x,h.y,de.x,de.y),h=c[Z],R=c[Z+1]}b.temp.lineTo(h.x,h.y),b.temp.stroke()},ze=({points:c,brush_color:C,brush_radius:z})=>{if(!c||c.length<2)return;n(23,b.temp_fake.lineJoin="round",b),n(23,b.temp_fake.lineCap="round",b),n(23,b.temp_fake.strokeStyle="#fff",b),n(23,b.temp_fake.lineWidth=z,b);let h=c[0],R=c[1];b.temp_fake.moveTo(R.x,R.y),b.temp_fake.beginPath();for(var Z=1,Je=c.length;Z<Je;Z++){var de=rt(h,R);b.temp_fake.quadraticCurveTo(h.x,h.y,de.x,de.y),h=c[Z],R=c[Z+1]}b.temp_fake.lineTo(h.x,h.y),b.temp_fake.stroke()},Me=()=>{W.length<1||(W.length=0,b.mask.drawImage(M.temp_fake,0,0,m,a),se())},je=()=>{W.length<1||(H.push({points:W.slice(),brush_color:o,brush_radius:g}),u!=="mask"&&(W.length=0),b.drawing.drawImage(M.temp,0,0,m,a),se())},se=()=>{const c=Te();l("change",c)};function _e(){return n(24,H=[]),Be(),n(4,le=0),!0}function Be(){ne=!0,b.temp.clearRect(0,0,m,a),n(23,b.temp.fillStyle=u==="mask"?"transparent":"#FFFFFF",b),b.temp.fillRect(0,0,m,a),u==="mask"&&(b.temp_fake.clearRect(0,0,M.temp_fake.width,M.temp_fake.height),b.mask.clearRect(0,0,m,a),n(23,b.mask.fillStyle="#000",b),b.mask.fillRect(0,0,m,a))}let ge=({once:c=!1}={})=>{if(te||ne){const C=k.getPointerCoordinates(),z=k.getBrushCoordinates();qe(b.interface,C,z),te=!1,ne=!1}c||window.requestAnimationFrame(()=>{ge()})},qe=(c,C,z)=>{c.clearRect(0,0,m,a),c.beginPath(),c.fillStyle=o,c.arc(z.x,z.y,g/2,0,Math.PI*2,!0),c.fill(),c.beginPath(),c.fillStyle=Gt,c.arc(z.x,z.y,i,0,Math.PI*2,!0),c.fill()};function Te(){return u==="mask"?M.mask.toDataURL("image/jpg"):M.drawing.toDataURL("image/jpg")}function Oe(c){ce.call(this,t,c)}function Pe(c,C){E[c?"unshift":"push"](()=>{M[C]=c,n(0,M)})}function We(c){E[c?"unshift":"push"](()=>{K=c,n(3,K)})}function He(){v=this.offsetWidth,D=this.offsetHeight,n(1,v),n(2,D)}return t.$$set=c=>{"value"in c&&n(10,r=c.value),"value_img"in c&&n(11,s=c.value_img),"mode"in c&&n(12,u=c.mode),"brush_color"in c&&n(13,o=c.brush_color),"brush_radius"in c&&n(9,g=c.brush_radius),"source"in c&&n(14,_=c.source),"width"in c&&n(15,m=c.width),"height"in c&&n(16,a=c.height),"container_height"in c&&n(17,f=c.container_height)},t.$$.update=()=>{t.$$.dirty[0]&2098176&&p&&!r&&_e(),t.$$.dirty[0]&31574017&&p&&s!==ee&&(n(22,ee=s),_e(),setTimeout(()=>{_==="webcam"?(b.temp.save(),b.temp.translate(m,0),b.temp.scale(-1,1),b.temp.drawImage(s,0,0),b.temp.restore()):b.temp.drawImage(s,0,0),b.drawing.drawImage(M.temp,0,0,m,a),me({lines:H.slice()}),se()},50)),t.$$.dirty[0]&33554944&&k&&(re(),k.setRadius(g*.05)),t.$$.dirty[0]&98304&&(m||a)&&Ae(),t.$$.dirty[0]&512&&(i=g*.075)},[M,v,D,K,le,ue,Ne,ke,Fe,g,r,s,u,o,_,m,a,f,Ue,_e,Te,p,ee,b,H,k,Oe,Pe,We,He]}class Ve extends ${constructor(e){super(),x(this,e,Kt,Vt,Y,{value:10,value_img:11,mode:12,brush_color:13,brush_radius:9,source:14,width:15,height:16,container_height:17,undo:18,clear:19,get_image_data:20},null,[-1,-1])}get undo(){return this.$$.ctx[18]}get clear(){return this.$$.ctx[19]}get get_image_data(){return this.$$.ctx[20]}}function Zt(t){let e,n,i,l,r;return n=new Ee({props:{Icon:Ut,label:"Undo"}}),n.$on("click",t[1]),l=new Ee({props:{Icon:Nt,label:"Clear"}}),l.$on("click",t[2]),{c(){e=U("div"),j(n.$$.fragment),i=L(),j(l.$$.fragment),d(e,"class","z-50 top-2 right-2 justify-end flex gap-1 absolute")},m(s,u){I(s,e,u),B(n,e,null),S(e,i),B(l,e,null),r=!0},p:N,i(s){r||(w(n.$$.fragment,s),w(l.$$.fragment,s),r=!0)},o(s){A(n.$$.fragment,s),A(l.$$.fragment,s),r=!1},d(s){s&&y(e),T(n),T(l)}}}function $t(t){const e=he();return[e,()=>e("undo"),l=>{e("clear"),l.stopPropagation()}]}class Ge extends ${constructor(e){super(),x(this,e,$t,Zt,Y,{})}}function st(t){let e,n,i,l,r;return{c(){e=U("input"),d(e,"aria-label","Brush radius"),d(e,"class","absolute top-[2px] right-6"),d(e,"type","range"),d(e,"min",n=.5*(t[2]/t[6])),d(e,"max",i=75*(t[2]/t[6]))},m(s,u){I(s,e,u),Re(e,t[0]),l||(r=[P(e,"change",t[10]),P(e,"input",t[10])],l=!0)},p(s,u){u&68&&n!==(n=.5*(s[2]/s[6]))&&d(e,"min",n),u&68&&i!==(i=75*(s[2]/s[6]))&&d(e,"max",i),u&1&&Re(e,s[0])},d(s){s&&y(e),l=!1,pt(r)}}}function ot(t){let e,n,i,l;n=new Ee({props:{Icon:Wt,label:"Select brush color"}}),n.$on("click",t[11]);let r=t[5]&&ut(t);return{c(){e=U("span"),j(n.$$.fragment),i=L(),r&&r.c(),d(e,"class","absolute top-6 right-0")},m(s,u){I(s,e,u),B(n,e,null),S(e,i),r&&r.m(e,null),l=!0},p(s,u){s[5]?r?r.p(s,u):(r=ut(s),r.c(),r.m(e,null)):r&&(r.d(1),r=null)},i(s){l||(w(n.$$.fragment,s),l=!0)},o(s){A(n.$$.fragment,s),l=!1},d(s){s&&y(e),T(n),r&&r.d()}}}function ut(t){let e,n,i;return{c(){e=U("input"),d(e,"aria-label","Brush color"),d(e,"class","absolute top-[-3px] right-6"),d(e,"type","color")},m(l,r){I(l,e,r),Re(e,t[1]),n||(i=P(e,"input",t[12]),n=!0)},p(l,r){r&2&&Re(e,l[1])},d(l){l&&y(e),n=!1,i()}}}function xt(t){let e,n,i,l,r,s;i=new Ee({props:{Icon:Ot,label:"Use brush"}}),i.$on("click",t[9]);let u=t[4]&&st(t),o=t[3]!=="mask"&&ot(t);return{c(){e=U("div"),n=U("span"),j(i.$$.fragment),l=L(),u&&u.c(),r=L(),o&&o.c(),d(n,"class","absolute top-0 right-0"),d(e,"class","z-50 top-10 right-2 justify-end flex gap-1 absolute")},m(g,_){I(g,e,_),S(e,n),B(i,n,null),S(n,l),u&&u.m(n,null),S(e,r),o&&o.m(e,null),s=!0},p(g,[_]){g[4]?u?u.p(g,_):(u=st(g),u.c(),u.m(n,null)):u&&(u.d(1),u=null),g[3]!=="mask"?o?(o.p(g,_),_&8&&w(o,1)):(o=ot(g),o.c(),w(o,1),o.m(e,null)):o&&(V(),A(o,1,1,()=>{o=null}),G())},i(g){s||(w(i.$$.fragment,g),w(o),s=!0)},o(g){A(i.$$.fragment,g),A(o),s=!1},d(g){g&&y(e),T(i),u&&u.d(),o&&o.d()}}}function en(t,e,n){let i;he();let l=!1,r=!1,{brush_radius:s=20}=e,{brush_color:u="#000"}=e,{container_height:o}=e,{img_width:g}=e,{img_height:_}=e,{mode:m="other"}=e;const a=()=>n(4,l=!l);function f(){s=Rt(this.value),n(0,s)}const p=()=>n(5,r=!r);function v(){u=this.value,n(1,u)}return t.$$set=D=>{"brush_radius"in D&&n(0,s=D.brush_radius),"brush_color"in D&&n(1,u=D.brush_color),"container_height"in D&&n(7,o=D.container_height),"img_width"in D&&n(2,g=D.img_width),"img_height"in D&&n(8,_=D.img_height),"mode"in D&&n(3,m=D.mode)},t.$$.update=()=>{t.$$.dirty&388&&n(6,i=o*(g/_))},[s,u,g,m,l,r,i,o,_,a,f,p,v]}class Ke extends ${constructor(e){super(),x(this,e,en,xt,Y,{brush_radius:0,brush_color:1,container_height:7,img_width:2,img_height:8,mode:3})}}function tn(t){let e,n;return{c(){e=U("img"),d(e,"class","w-full h-full object-contain"),O(e.src,n=t[0].image||t[0])||d(e,"src",n),d(e,"alt",""),q(e,"scale-x-[-1]",t[4]==="webcam"&&t[10])},m(i,l){I(i,e,l)},p(i,l){l[0]&1&&!O(e.src,n=i[0].image||i[0])&&d(e,"src",n),l[0]&1040&&q(e,"scale-x-[-1]",i[4]==="webcam"&&i[10])},i:N,o:N,d(i){i&&y(e)}}}function nn(t){let e=t[21],n,i,l,r=at(t),s=t[15]>0&&ft(t);return{c(){r.c(),n=L(),s&&s.c(),i=oe()},m(u,o){r.m(u,o),I(u,n,o),s&&s.m(u,o),I(u,i,o),l=!0},p(u,o){o[0]&2097152&&Y(e,e=u[21])?(r.d(1),r=at(u),r.c(),r.m(n.parentNode,n)):r.p(u,o),u[15]>0?s?(s.p(u,o),o[0]&32768&&w(s,1)):(s=ft(u),s.c(),w(s,1),s.m(i.parentNode,i)):s&&(V(),A(s,1,1,()=>{s=null}),G())},i(u){l||(w(s),l=!0)},o(u){A(s),l=!1},d(u){r.d(u),u&&y(n),s&&s.d(u),u&&y(i)}}}function ln(t){let e,n,i,l,r;return e=new Le({props:{editable:!0}}),e.$on("edit",t[48]),e.$on("clear",t[24]),{c(){j(e.$$.fragment),n=L(),i=U("img"),d(i,"class","w-full h-full object-contain"),O(i.src,l=t[0])||d(i,"src",l),d(i,"alt",""),q(i,"scale-x-[-1]",t[4]==="webcam"&&t[10])},m(s,u){B(e,s,u),I(s,n,u),I(s,i,u),r=!0},p(s,u){(!r||u[0]&1&&!O(i.src,l=s[0]))&&d(i,"src",l),u[0]&1040&&q(i,"scale-x-[-1]",s[4]==="webcam"&&s[10])},i(s){r||(w(e.$$.fragment,s),r=!0)},o(s){A(e.$$.fragment,s),r=!1},d(s){T(e,s),s&&y(n),s&&y(i)}}}function rn(t){let e,n,i,l;return e=new vt({props:{image:t[0]}}),e.$on("crop",t[25]),i=new Le({}),i.$on("clear",t[47]),{c(){j(e.$$.fragment),n=L(),j(i.$$.fragment)},m(r,s){B(e,r,s),I(r,n,s),B(i,r,s),l=!0},p(r,s){const u={};s[0]&1&&(u.image=r[0]),e.$set(u)},i(r){l||(w(e.$$.fragment,r),w(i.$$.fragment,r),l=!0)},o(r){A(e.$$.fragment,r),A(i.$$.fragment,r),l=!1},d(r){T(e,r),r&&y(n),T(i,r)}}}function sn(t){let e,n,i=t[4]==="webcam"&&!t[21]&&ct(t);return{c(){i&&i.c(),e=oe()},m(l,r){i&&i.m(l,r),I(l,e,r),n=!0},p(l,r){l[4]==="webcam"&&!l[21]?i?(i.p(l,r),r[0]&2097168&&w(i,1)):(i=ct(l),i.c(),w(i,1),i.m(e.parentNode,e)):i&&(V(),A(i,1,1,()=>{i=null}),G())},i(l){n||(w(i),n=!0)},o(l){A(i),n=!1},d(l){i&&i.d(l),l&&y(e)}}}function on(t){let e,n,i,l,r,s,u;e=new Ge({}),e.$on("undo",t[38]),e.$on("clear",t[39]);let o=t[1]==="color-sketch"&&ht(t);function g(a){t[42](a)}function _(a){t[43](a)}let m={value:t[0],mode:t[12],width:t[15]||t[20],height:t[14]||t[19],container_height:t[16]||t[19]};return t[17]!==void 0&&(m.brush_radius=t[17]),t[22]!==void 0&&(m.brush_color=t[22]),l=new Ve({props:m}),E.push(()=>J(l,"brush_radius",g)),E.push(()=>J(l,"brush_color",_)),t[44](l),l.$on("change",t[25]),{c(){j(e.$$.fragment),n=L(),o&&o.c(),i=L(),j(l.$$.fragment)},m(a,f){B(e,a,f),I(a,n,f),o&&o.m(a,f),I(a,i,f),B(l,a,f),u=!0},p(a,f){a[1]==="color-sketch"?o?(o.p(a,f),f[0]&2&&w(o,1)):(o=ht(a),o.c(),w(o,1),o.m(i.parentNode,i)):o&&(V(),A(o,1,1,()=>{o=null}),G());const p={};f[0]&1&&(p.value=a[0]),f[0]&4096&&(p.mode=a[12]),f[0]&1081344&&(p.width=a[15]||a[20]),f[0]&540672&&(p.height=a[14]||a[19]),f[0]&589824&&(p.container_height=a[16]||a[19]),!r&&f[0]&131072&&(r=!0,p.brush_radius=a[17],Q(()=>r=!1)),!s&&f[0]&4194304&&(s=!0,p.brush_color=a[22],Q(()=>s=!1)),l.$set(p)},i(a){u||(w(e.$$.fragment,a),w(o),w(l.$$.fragment,a),u=!0)},o(a){A(e.$$.fragment,a),A(o),A(l.$$.fragment,a),u=!1},d(a){T(e,a),a&&y(n),o&&o.d(a),a&&y(i),t[44](null),T(l,a)}}}function un(t){let e,n,i;function l(s){t[37](s)}let r={filetype:"image/x-png,image/gif,image/jpeg",include_file_metadata:!1,disable_click:!!t[0],$$slots:{default:[mn]},$$scope:{ctx:t}};return t[11]!==void 0&&(r.dragging=t[11]),e=new Ft({props:r}),E.push(()=>J(e,"dragging",l)),e.$on("load",t[23]),{c(){j(e.$$.fragment)},m(s,u){B(e,s,u),i=!0},p(s,u){const o={};u[0]&1&&(o.disable_click=!!s[0]),u[0]&8386035|u[1]&134217728&&(o.$$scope={dirty:u,ctx:s}),!n&&u[0]&2048&&(n=!0,o.dragging=s[11],Q(()=>n=!1)),e.$set(o)},i(s){i||(w(e.$$.fragment,s),i=!0)},o(s){A(e.$$.fragment,s),i=!1},d(s){T(e,s)}}}function at(t){let e,n,i,l;return{c(){var r;e=U("img"),d(e,"class","absolute w-full h-full object-contain"),O(e.src,n=t[21]||((r=t[0])==null?void 0:r.image)||t[0])||d(e,"src",n),d(e,"alt",""),q(e,"scale-x-[-1]",t[4]==="webcam"&&t[10])},m(r,s){I(r,e,s),t[49](e),i||(l=P(e,"load",t[26]),i=!0)},p(r,s){var u;s[0]&2097153&&!O(e.src,n=r[21]||((u=r[0])==null?void 0:u.image)||r[0])&&d(e,"src",n),s[0]&1040&&q(e,"scale-x-[-1]",r[4]==="webcam"&&r[10])},d(r){r&&y(e),t[49](null),i=!1,l()}}}function ft(t){let e,n,i,l,r,s,u,o;function g(f){t[51](f)}function _(f){t[52](f)}let m={value:t[0],mode:t[12],width:t[15]||t[20],height:t[14]||t[19],container_height:t[16]||t[19],value_img:t[18],source:t[4]};t[17]!==void 0&&(m.brush_radius=t[17]),t[22]!==void 0&&(m.brush_color=t[22]),e=new Ve({props:m}),t[50](e),E.push(()=>J(e,"brush_radius",g)),E.push(()=>J(e,"brush_color",_)),e.$on("change",t[25]),r=new Ge({}),r.$on("undo",t[53]),r.$on("clear",t[27]);let a=(t[1]==="color-sketch"||t[1]==="sketch")&&_t(t);return{c(){j(e.$$.fragment),l=L(),j(r.$$.fragment),s=L(),a&&a.c(),u=oe()},m(f,p){B(e,f,p),I(f,l,p),B(r,f,p),I(f,s,p),a&&a.m(f,p),I(f,u,p),o=!0},p(f,p){const v={};p[0]&1&&(v.value=f[0]),p[0]&4096&&(v.mode=f[12]),p[0]&1081344&&(v.width=f[15]||f[20]),p[0]&540672&&(v.height=f[14]||f[19]),p[0]&589824&&(v.container_height=f[16]||f[19]),p[0]&262144&&(v.value_img=f[18]),p[0]&16&&(v.source=f[4]),!n&&p[0]&131072&&(n=!0,v.brush_radius=f[17],Q(()=>n=!1)),!i&&p[0]&4194304&&(i=!0,v.brush_color=f[22],Q(()=>i=!1)),e.$set(v),f[1]==="color-sketch"||f[1]==="sketch"?a?(a.p(f,p),p[0]&2&&w(a,1)):(a=_t(f),a.c(),w(a,1),a.m(u.parentNode,u)):a&&(V(),A(a,1,1,()=>{a=null}),G())},i(f){o||(w(e.$$.fragment,f),w(r.$$.fragment,f),w(a),o=!0)},o(f){A(e.$$.fragment,f),A(r.$$.fragment,f),A(a),o=!1},d(f){t[50](null),T(e,f),f&&y(l),T(r,f),f&&y(s),a&&a.d(f),f&&y(u)}}}function _t(t){let e,n,i,l;function r(o){t[54](o)}function s(o){t[55](o)}let u={container_height:t[16]||t[19],img_width:t[15]||t[20],img_height:t[14]||t[19],mode:t[12]};return t[17]!==void 0&&(u.brush_radius=t[17]),t[22]!==void 0&&(u.brush_color=t[22]),e=new Ke({props:u}),E.push(()=>J(e,"brush_radius",r)),E.push(()=>J(e,"brush_color",s)),{c(){j(e.$$.fragment)},m(o,g){B(e,o,g),l=!0},p(o,g){const _={};g[0]&589824&&(_.container_height=o[16]||o[19]),g[0]&1081344&&(_.img_width=o[15]||o[20]),g[0]&540672&&(_.img_height=o[14]||o[19]),g[0]&4096&&(_.mode=o[12]),!n&&g[0]&131072&&(n=!0,_.brush_radius=o[17],Q(()=>n=!1)),!i&&g[0]&4194304&&(i=!0,_.brush_color=o[22],Q(()=>i=!1)),e.$set(_)},i(o){l||(w(e.$$.fragment,o),l=!0)},o(o){A(e.$$.fragment,o),l=!1},d(o){T(e,o)}}}function ct(t){let e,n;return e=new Dt({props:{streaming:t[8],pending:t[9],mirror_webcam:t[10]}}),e.$on("capture",t[45]),e.$on("stream",t[25]),e.$on("error",t[46]),{c(){j(e.$$.fragment)},m(i,l){B(e,i,l),n=!0},p(i,l){const r={};l[0]&256&&(r.streaming=i[8]),l[0]&512&&(r.pending=i[9]),l[0]&1024&&(r.mirror_webcam=i[10]),e.$set(r)},i(i){n||(w(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){T(e,i)}}}function ht(t){let e,n,i,l;function r(o){t[40](o)}function s(o){t[41](o)}let u={container_height:t[16]||t[19],img_width:t[15]||t[20],img_height:t[14]||t[19]};return t[17]!==void 0&&(u.brush_radius=t[17]),t[22]!==void 0&&(u.brush_color=t[22]),e=new Ke({props:u}),E.push(()=>J(e,"brush_radius",r)),E.push(()=>J(e,"brush_color",s)),{c(){j(e.$$.fragment)},m(o,g){B(e,o,g),l=!0},p(o,g){const _={};g[0]&589824&&(_.container_height=o[16]||o[19]),g[0]&1081344&&(_.img_width=o[15]||o[20]),g[0]&540672&&(_.img_height=o[14]||o[19]),!n&&g[0]&131072&&(n=!0,_.brush_radius=o[17],Q(()=>n=!1)),!i&&g[0]&4194304&&(i=!0,_.brush_color=o[22],Q(()=>i=!1)),e.$set(_)},i(o){l||(w(e.$$.fragment,o),l=!0)},o(o){A(e.$$.fragment,o),l=!1},d(o){T(e,o)}}}function an(t){let e,n;return{c(){e=U("img"),d(e,"class","w-full h-full object-contain"),O(e.src,n=t[0].image||t[0])||d(e,"src",n),d(e,"alt",""),q(e,"scale-x-[-1]",t[4]==="webcam"&&t[10])},m(i,l){I(i,e,l)},p(i,l){l[0]&1&&!O(e.src,n=i[0].image||i[0])&&d(e,"src",n),l[0]&1040&&q(e,"scale-x-[-1]",i[4]==="webcam"&&i[10])},i:N,o:N,d(i){i&&y(e)}}}function fn(t){let e=t[21],n,i,l,r=mt(t),s=t[15]>0&&gt(t);return{c(){r.c(),n=L(),s&&s.c(),i=oe()},m(u,o){r.m(u,o),I(u,n,o),s&&s.m(u,o),I(u,i,o),l=!0},p(u,o){o[0]&2097152&&Y(e,e=u[21])?(r.d(1),r=mt(u),r.c(),r.m(n.parentNode,n)):r.p(u,o),u[15]>0?s?(s.p(u,o),o[0]&32768&&w(s,1)):(s=gt(u),s.c(),w(s,1),s.m(i.parentNode,i)):s&&(V(),A(s,1,1,()=>{s=null}),G())},i(u){l||(w(s),l=!0)},o(u){A(s),l=!1},d(u){r.d(u),u&&y(n),s&&s.d(u),u&&y(i)}}}function _n(t){let e,n,i,l,r;return e=new Le({props:{editable:!0}}),e.$on("edit",t[29]),e.$on("clear",t[24]),{c(){j(e.$$.fragment),n=L(),i=U("img"),d(i,"class","w-full h-full object-contain"),O(i.src,l=t[0])||d(i,"src",l),d(i,"alt",""),q(i,"scale-x-[-1]",t[4]==="webcam"&&t[10])},m(s,u){B(e,s,u),I(s,n,u),I(s,i,u),r=!0},p(s,u){(!r||u[0]&1&&!O(i.src,l=s[0]))&&d(i,"src",l),u[0]&1040&&q(i,"scale-x-[-1]",s[4]==="webcam"&&s[10])},i(s){r||(w(e.$$.fragment,s),r=!0)},o(s){A(e.$$.fragment,s),r=!1},d(s){T(e,s),s&&y(n),s&&y(i)}}}function cn(t){let e,n,i,l;return e=new vt({props:{image:t[0]}}),e.$on("crop",t[25]),i=new Le({}),i.$on("clear",t[28]),{c(){j(e.$$.fragment),n=L(),j(i.$$.fragment)},m(r,s){B(e,r,s),I(r,n,s),B(i,r,s),l=!0},p(r,s){const u={};s[0]&1&&(u.image=r[0]),e.$set(u)},i(r){l||(w(e.$$.fragment,r),w(i.$$.fragment,r),l=!0)},o(r){A(e.$$.fragment,r),A(i.$$.fragment,r),l=!1},d(r){T(e,r),r&&y(n),T(i,r)}}}function hn(t){let e,n,i,l,r,s,u,o,g;return{c(){e=U("div"),n=be(t[5]),i=L(),l=U("span"),r=be("- "),s=be(t[6]),u=be(" -"),o=L(),g=be(t[7]),d(l,"class","text-gray-300"),d(e,"class","flex flex-col")},m(_,m){I(_,e,m),S(e,n),S(e,i),S(e,l),S(l,r),S(l,s),S(l,u),S(e,o),S(e,g)},p(_,m){m[0]&32&&Qe(n,_[5]),m[0]&64&&Qe(s,_[6]),m[0]&128&&Qe(g,_[7])},i:N,o:N,d(_){_&&y(e)}}}function mt(t){let e,n,i,l;return{c(){var r;e=U("img"),d(e,"class","absolute w-full h-full object-contain"),O(e.src,n=t[21]||((r=t[0])==null?void 0:r.image)||t[0])||d(e,"src",n),d(e,"alt",""),q(e,"scale-x-[-1]",t[4]==="webcam"&&t[10])},m(r,s){I(r,e,s),t[30](e),i||(l=P(e,"load",t[26]),i=!0)},p(r,s){var u;s[0]&2097153&&!O(e.src,n=r[21]||((u=r[0])==null?void 0:u.image)||r[0])&&d(e,"src",n),s[0]&1040&&q(e,"scale-x-[-1]",r[4]==="webcam"&&r[10])},d(r){r&&y(e),t[30](null),i=!1,l()}}}function gt(t){let e,n,i,l,r,s,u,o;function g(f){t[32](f)}function _(f){t[33](f)}let m={value:t[0],mode:t[12],width:t[15]||t[20],height:t[14]||t[19],container_height:t[16]||t[19],value_img:t[18],source:t[4]};t[17]!==void 0&&(m.brush_radius=t[17]),t[22]!==void 0&&(m.brush_color=t[22]),e=new Ve({props:m}),t[31](e),E.push(()=>J(e,"brush_radius",g)),E.push(()=>J(e,"brush_color",_)),e.$on("change",t[25]),r=new Ge({}),r.$on("undo",t[34]),r.$on("clear",t[27]);let a=(t[1]==="color-sketch"||t[1]==="sketch")&&dt(t);return{c(){j(e.$$.fragment),l=L(),j(r.$$.fragment),s=L(),a&&a.c(),u=oe()},m(f,p){B(e,f,p),I(f,l,p),B(r,f,p),I(f,s,p),a&&a.m(f,p),I(f,u,p),o=!0},p(f,p){const v={};p[0]&1&&(v.value=f[0]),p[0]&4096&&(v.mode=f[12]),p[0]&1081344&&(v.width=f[15]||f[20]),p[0]&540672&&(v.height=f[14]||f[19]),p[0]&589824&&(v.container_height=f[16]||f[19]),p[0]&262144&&(v.value_img=f[18]),p[0]&16&&(v.source=f[4]),!n&&p[0]&131072&&(n=!0,v.brush_radius=f[17],Q(()=>n=!1)),!i&&p[0]&4194304&&(i=!0,v.brush_color=f[22],Q(()=>i=!1)),e.$set(v),f[1]==="color-sketch"||f[1]==="sketch"?a?(a.p(f,p),p[0]&2&&w(a,1)):(a=dt(f),a.c(),w(a,1),a.m(u.parentNode,u)):a&&(V(),A(a,1,1,()=>{a=null}),G())},i(f){o||(w(e.$$.fragment,f),w(r.$$.fragment,f),w(a),o=!0)},o(f){A(e.$$.fragment,f),A(r.$$.fragment,f),A(a),o=!1},d(f){t[31](null),T(e,f),f&&y(l),T(r,f),f&&y(s),a&&a.d(f),f&&y(u)}}}function dt(t){let e,n,i,l;function r(o){t[35](o)}function s(o){t[36](o)}let u={container_height:t[16]||t[19],img_width:t[15]||t[20],img_height:t[14]||t[19],mode:t[12]};return t[17]!==void 0&&(u.brush_radius=t[17]),t[22]!==void 0&&(u.brush_color=t[22]),e=new Ke({props:u}),E.push(()=>J(e,"brush_radius",r)),E.push(()=>J(e,"brush_color",s)),{c(){j(e.$$.fragment)},m(o,g){B(e,o,g),l=!0},p(o,g){const _={};g[0]&589824&&(_.container_height=o[16]||o[19]),g[0]&1081344&&(_.img_width=o[15]||o[20]),g[0]&540672&&(_.img_height=o[14]||o[19]),g[0]&4096&&(_.mode=o[12]),!n&&g[0]&131072&&(n=!0,_.brush_radius=o[17],Q(()=>n=!1)),!i&&g[0]&4194304&&(i=!0,_.brush_color=o[22],Q(()=>i=!1)),e.$set(_)},i(o){l||(w(e.$$.fragment,o),l=!0)},o(o){A(e.$$.fragment,o),l=!1},d(o){T(e,o)}}}function mn(t){let e,n,i,l;const r=[hn,cn,_n,fn,an],s=[];function u(o,g){return o[0]===null&&!o[21]||o[8]?0:o[1]==="select"?1:o[1]==="editor"?2:(o[1]==="sketch"||o[1]==="color-sketch")&&(o[0]!==null||o[21])?3:4}return e=u(t),n=s[e]=r[e](t),{c(){n.c(),i=oe()},m(o,g){s[e].m(o,g),I(o,i,g),l=!0},p(o,g){let _=e;e=u(o),e===_?s[e].p(o,g):(V(),A(s[_],1,1,()=>{s[_]=null}),G(),n=s[e],n?n.p(o,g):(n=s[e]=r[e](o),n.c()),w(n,1),n.m(i.parentNode,i))},i(o){l||(w(n),l=!0)},o(o){A(n),l=!1},d(o){s[e].d(o),o&&y(i)}}}function gn(t){let e,n,i,l,r,s,u;e=new wt({props:{show_label:t[3],Icon:t[4]==="canvas"?xe:De,label:t[2]||(t[4]==="canvas"?"Sketch":"Image")}});const o=[un,on,sn,rn,ln,nn,tn],g=[];function _(m,a){return m[4]==="upload"?0:m[4]==="canvas"?1:m[0]===null&&!m[21]||m[8]?2:m[1]==="select"?3:m[1]==="editor"?4:(m[1]==="sketch"||m[1]==="color-sketch")&&(m[0]!==null||m[21])?5:6}return l=_(t),r=g[l]=o[l](t),{c(){j(e.$$.fragment),n=L(),i=U("div"),r.c(),d(i,"data-testid","image"),Ye(()=>t[56].call(i)),q(i,"bg-gray-200",t[0]),q(i,"h-60",t[4]!=="webcam"||t[1]==="sketch"||t[1]==="color-sketch")},m(m,a){B(e,m,a),I(m,n,a),I(m,i,a),g[l].m(i,null),s=bt(i,t[56].bind(i)),u=!0},p(m,a){const f={};a[0]&8&&(f.show_label=m[3]),a[0]&16&&(f.Icon=m[4]==="canvas"?xe:De),a[0]&20&&(f.label=m[2]||(m[4]==="canvas"?"Sketch":"Image")),e.$set(f);let p=l;l=_(m),l===p?g[l].p(m,a):(V(),A(g[p],1,1,()=>{g[p]=null}),G(),r=g[l],r?r.p(m,a):(r=g[l]=o[l](m),r.c()),w(r,1),r.m(i,null)),a[0]&1&&q(i,"bg-gray-200",m[0]),a[0]&18&&q(i,"h-60",m[4]!=="webcam"||m[1]==="sketch"||m[1]==="color-sketch")},i(m){u||(w(e.$$.fragment,m),w(r),u=!0)},o(m){A(e.$$.fragment,m),A(r),u=!1},d(m){T(e,m),m&&y(n),m&&y(i),g[l].d(),s()}}}function dn(t,e,n){let i,{value:l}=e,{label:r=void 0}=e,{show_label:s}=e,{source:u="upload"}=e,{tool:o="editor"}=e,{drop_text:g="Drop an image file"}=e,{or_text:_="or"}=e,{upload_text:m="click to upload"}=e,{streaming:a=!1}=e,{pending:f=!1}=e,{mirror_webcam:p}=e,v;l&&(u==="upload"||u==="webcam")&&o==="sketch"&&(l={image:l,mask:null});function D({detail:h}){o==="color-sketch"?n(21,re=h):n(0,l=(u==="upload"||u==="webcam")&&o==="sketch"?{image:h,mask:null}:h),M("upload",h)}function ee({detail:h}){n(0,l=null),n(21,re=void 0),M("clear")}async function ue({detail:h},R){k==="mask"?u==="webcam"&&R?n(0,l={image:h,mask:null}):n(0,l={image:typeof l=="string"?l:l?.image||null,mask:h}):(u==="upload"||u==="webcam")&&o==="sketch"?n(0,l={image:h,mask:null}):n(0,l=h),await Se(),M(a?"stream":"edit")}const M=he();let b=!1;function W(h){const R=h.composedPath()[0];n(15,ne=R.naturalWidth),n(14,te=R.naturalHeight),n(16,ie=R.getBoundingClientRect().height)}async function H(){v.clear(),await Se(),n(0,l=null),n(21,re=void 0)}let te=0,ne=0,ie=0,F=20,k,K,ae,le,re;const Ue=h=>(ee(h),n(1,o="editor")),me=()=>n(1,o="select");function Ne(h){E[h?"unshift":"push"](()=>{K=h,n(18,K)})}function ke(h){E[h?"unshift":"push"](()=>{v=h,n(13,v)})}function Fe(h){F=h,n(17,F)}function pe(h){i=h,n(22,i),n(12,k),n(4,u),n(1,o)}const we=()=>v.undo();function ve(h){F=h,n(17,F)}function Ae(h){i=h,n(22,i),n(12,k),n(4,u),n(1,o)}function fe(h){b=h,n(11,b)}const Ie=()=>v.undo(),ye=()=>v.clear();function Ce(h){F=h,n(17,F)}function ze(h){i=h,n(22,i),n(12,k),n(4,u),n(1,o)}function Me(h){F=h,n(17,F)}function je(h){i=h,n(22,i),n(12,k),n(4,u),n(1,o)}function se(h){E[h?"unshift":"push"](()=>{v=h,n(13,v)})}const _e=h=>o==="color-sketch"?D(h):ue(h,!0);function Be(h){ce.call(this,t,h)}const ge=h=>(ee(h),n(1,o="editor")),qe=()=>n(1,o="select");function Te(h){E[h?"unshift":"push"](()=>{K=h,n(18,K)})}function Oe(h){E[h?"unshift":"push"](()=>{v=h,n(13,v)})}function Pe(h){F=h,n(17,F)}function We(h){i=h,n(22,i),n(12,k),n(4,u),n(1,o)}const He=()=>v.undo();function c(h){F=h,n(17,F)}function C(h){i=h,n(22,i),n(12,k),n(4,u),n(1,o)}function z(){ae=this.offsetHeight,le=this.offsetWidth,n(19,ae),n(20,le)}return t.$$set=h=>{"value"in h&&n(0,l=h.value),"label"in h&&n(2,r=h.label),"show_label"in h&&n(3,s=h.show_label),"source"in h&&n(4,u=h.source),"tool"in h&&n(1,o=h.tool),"drop_text"in h&&n(5,g=h.drop_text),"or_text"in h&&n(6,_=h.or_text),"upload_text"in h&&n(7,m=h.upload_text),"streaming"in h&&n(8,a=h.streaming),"pending"in h&&n(9,f=h.pending),"mirror_webcam"in h&&n(10,p=h.mirror_webcam)},t.$$.update=()=>{t.$$.dirty[0]&1&&M("change",l),t.$$.dirty[0]&2048&&M("drag",b),t.$$.dirty[0]&18&&(u==="canvas"&&o==="sketch"?n(12,k="bw-sketch"):o==="color-sketch"?n(12,k="color-sketch"):(u==="upload"||u==="webcam")&&o==="sketch"?n(12,k="mask"):n(12,k="editor")),t.$$.dirty[0]&4096&&n(22,i=k=="mask"?"#000000":"#000"),t.$$.dirty[0]&1&&(l===null||l.image===null&&l.mask===null)&&n(21,re=void 0)},[l,o,r,s,u,g,_,m,a,f,p,b,k,v,te,ne,ie,F,K,ae,le,re,i,D,ee,ue,W,H,Ue,me,Ne,ke,Fe,pe,we,ve,Ae,fe,Ie,ye,Ce,ze,Me,je,se,_e,Be,ge,qe,Te,Oe,Pe,We,He,c,C,z]}class bn extends ${constructor(e){super(),x(this,e,dn,gn,Y,{value:0,label:2,show_label:3,source:4,tool:1,drop_text:5,or_text:6,upload_text:7,streaming:8,pending:9,mirror_webcam:10},null,[-1,-1])}}function kn(t){let e,n;return{c(){e=U("img"),d(e,"class","w-full h-full object-contain"),O(e.src,n=t[0])||d(e,"src",n),d(e,"alt","")},m(i,l){I(i,e,l)},p(i,l){l&1&&!O(e.src,n=i[0])&&d(e,"src",n)},i:N,o:N,d(i){i&&y(e)}}}function pn(t){let e,n,i,l;return i=new De({}),{c(){e=U("div"),n=U("div"),j(i.$$.fragment),d(n,"class","h-5 dark:text-white opacity-50"),d(e,"class","h-full min-h-[15rem] flex justify-center items-center")},m(r,s){I(r,e,s),S(e,n),B(i,n,null),l=!0},p:N,i(r){l||(w(i.$$.fragment,r),l=!0)},o(r){A(i.$$.fragment,r),l=!1},d(r){r&&y(e),T(i)}}}function wn(t){let e,n,i,l,r,s;e=new wt({props:{show_label:t[2],Icon:De,label:t[1]||"Image"}});const u=[pn,kn],o=[];function g(_,m){return _[0]===null?0:1}return i=g(t),l=o[i]=u[i](t),{c(){j(e.$$.fragment),n=L(),l.c(),r=oe()},m(_,m){B(e,_,m),I(_,n,m),o[i].m(_,m),I(_,r,m),s=!0},p(_,[m]){const a={};m&4&&(a.show_label=_[2]),m&2&&(a.label=_[1]||"Image"),e.$set(a);let f=i;i=g(_),i===f?o[i].p(_,m):(V(),A(o[f],1,1,()=>{o[f]=null}),G(),l=o[i],l?l.p(_,m):(l=o[i]=u[i](_),l.c()),w(l,1),l.m(r.parentNode,r))},i(_){s||(w(e.$$.fragment,_),w(l),s=!0)},o(_){A(e.$$.fragment,_),A(l),s=!1},d(_){T(e,_),_&&y(n),o[i].d(_),_&&y(r)}}}function vn(t,e,n){let{value:i}=e,{label:l=void 0}=e,{show_label:r}=e;const s=he();return t.$$set=u=>{"value"in u&&n(0,i=u.value),"label"in u&&n(1,l=u.label),"show_label"in u&&n(2,r=u.show_label)},t.$$.update=()=>{t.$$.dirty&1&&i&&s("change",i)},[i,l,r]}class An extends ${constructor(e){super(),x(this,e,vn,wn,Y,{value:0,label:1,show_label:2})}}function In(t){let e,n,i;function l(s){t[15](s)}let r={source:t[4],tool:t[5],label:t[6],show_label:t[7],pending:t[9],streaming:t[8],drop_text:t[14]("interface.drop_image"),or_text:t[14]("or"),upload_text:t[14]("interface.click_to_upload"),mirror_webcam:t[11]};return t[0]!==void 0&&(r.value=t[0]),e=new bn({props:r}),E.push(()=>J(e,"value",l)),e.$on("edit",t[16]),e.$on("clear",t[17]),e.$on("change",t[18]),e.$on("stream",t[19]),e.$on("drag",t[20]),e.$on("upload",t[21]),e.$on("error",t[22]),{c(){j(e.$$.fragment)},m(s,u){B(e,s,u),i=!0},p(s,u){const o={};u&16&&(o.source=s[4]),u&32&&(o.tool=s[5]),u&64&&(o.label=s[6]),u&128&&(o.show_label=s[7]),u&512&&(o.pending=s[9]),u&256&&(o.streaming=s[8]),u&16384&&(o.drop_text=s[14]("interface.drop_image")),u&16384&&(o.or_text=s[14]("or")),u&16384&&(o.upload_text=s[14]("interface.click_to_upload")),u&2048&&(o.mirror_webcam=s[11]),!n&&u&1&&(n=!0,o.value=s[0],Q(()=>n=!1)),e.$set(o)},i(s){i||(w(e.$$.fragment,s),i=!0)},o(s){A(e.$$.fragment,s),i=!1},d(s){T(e,s)}}}function yn(t){let e,n;return e=new An({props:{value:t[0],label:t[6],show_label:t[7]}}),{c(){j(e.$$.fragment)},m(i,l){B(e,i,l),n=!0},p(i,l){const r={};l&1&&(r.value=i[0]),l&64&&(r.label=i[6]),l&128&&(r.show_label=i[7]),e.$set(r)},i(i){n||(w(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){T(e,i)}}}function Cn(t){let e,n,i,l,r,s;const u=[t[1]];let o={};for(let a=0;a<u.length;a+=1)o=Ct(o,u[a]);e=new zt({props:o});const g=[yn,In],_=[];function m(a,f){return a[12]==="static"?0:1}return i=m(t),l=_[i]=g[i](t),{c(){j(e.$$.fragment),n=L(),l.c(),r=oe()},m(a,f){B(e,a,f),I(a,n,f),_[i].m(a,f),I(a,r,f),s=!0},p(a,f){const p=f&2?Mt(u,[jt(a[1])]):{};e.$set(p);let v=i;i=m(a),i===v?_[i].p(a,f):(V(),A(_[v],1,1,()=>{_[v]=null}),G(),l=_[i],l?l.p(a,f):(l=_[i]=g[i](a),l.c()),w(l,1),l.m(r.parentNode,r))},i(a){s||(w(e.$$.fragment,a),w(l),s=!0)},o(a){A(e.$$.fragment,a),A(l),s=!1},d(a){T(e,a),a&&y(n),_[i].d(a),a&&y(r)}}}function zn(t){let e,n;return e=new At({props:{visible:t[3],variant:t[12]==="dynamic"&&t[0]===null&&t[4]==="upload"?"dashed":"solid",color:t[13]?"green":"grey",padding:!1,elem_id:t[2],style:{height:t[10].height,width:t[10].width},$$slots:{default:[Cn]},$$scope:{ctx:t}}}),{c(){j(e.$$.fragment)},m(i,l){B(e,i,l),n=!0},p(i,[l]){const r={};l&8&&(r.visible=i[3]),l&4113&&(r.variant=i[12]==="dynamic"&&i[0]===null&&i[4]==="upload"?"dashed":"solid"),l&8192&&(r.color=i[13]?"green":"grey"),l&4&&(r.elem_id=i[2]),l&1024&&(r.style={height:i[10].height,width:i[10].width}),l&16808947&&(r.$$scope={dirty:l,ctx:i}),e.$set(r)},i(i){n||(w(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){T(e,i)}}}function Mn(t,e,n){let i;It(t,yt,k=>n(14,i=k));let{elem_id:l=""}=e,{visible:r=!0}=e,{value:s=null}=e,{source:u="upload"}=e,{tool:o="editor"}=e,{label:g}=e,{show_label:_}=e,{streaming:m}=e,{pending:a}=e,{style:f={}}=e,{mirror_webcam:p}=e,{loading_status:v}=e,{mode:D}=e;const ee=he();let ue;function M(k){s=k,n(0,s)}function b(k){ce.call(this,t,k)}function W(k){ce.call(this,t,k)}function H(k){ce.call(this,t,k)}function te(k){ce.call(this,t,k)}const ne=({detail:k})=>n(13,ue=k);function ie(k){ce.call(this,t,k)}const F=({detail:k})=>{n(1,v=v||{}),n(1,v.status="error",v),n(1,v.message=k,v)};return t.$$set=k=>{"elem_id"in k&&n(2,l=k.elem_id),"visible"in k&&n(3,r=k.visible),"value"in k&&n(0,s=k.value),"source"in k&&n(4,u=k.source),"tool"in k&&n(5,o=k.tool),"label"in k&&n(6,g=k.label),"show_label"in k&&n(7,_=k.show_label),"streaming"in k&&n(8,m=k.streaming),"pending"in k&&n(9,a=k.pending),"style"in k&&n(10,f=k.style),"mirror_webcam"in k&&n(11,p=k.mirror_webcam),"loading_status"in k&&n(1,v=k.loading_status),"mode"in k&&n(12,D=k.mode)},t.$$.update=()=>{t.$$.dirty&1&&n(0,s=s||null),t.$$.dirty&1&&ee("change")},[s,v,l,r,u,o,g,_,m,a,f,p,D,ue,i,M,b,W,H,te,ne,ie,F]}class jn extends ${constructor(e){super(),x(this,e,Mn,zn,Y,{elem_id:2,visible:3,value:0,source:4,tool:5,label:6,show_label:7,streaming:8,pending:9,style:10,mirror_webcam:11,loading_status:1,mode:12})}}var Nn=jn;const Fn=["static","dynamic"],qn=t=>({type:"string",description:"image data as base64 string",example_data:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAACklEQVR4nGMAAQAABQABDQottAAAAABJRU5ErkJggg=="});export{Nn as Component,Wn as ExampleComponent,qn as document,Fn as modes};
