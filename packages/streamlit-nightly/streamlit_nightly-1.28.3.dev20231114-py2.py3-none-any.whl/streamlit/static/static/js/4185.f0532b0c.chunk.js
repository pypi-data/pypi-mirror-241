(self.webpackChunk_streamlit_app=self.webpackChunk_streamlit_app||[]).push([[4185],{72394:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return R}});var n=i(64649),o=i(22951),a=i(91976),r=i(67591),s=i(94337),c=i(50189),h=i(66845),l=i(59109),p=i(97365),d=i(62813),u=i.n(d),m=i(3717),g=i(25621),v=i(27466),f=i(43536),w=i(80248),x=i(44948),k=i(12879),b=i(47203),S=i(61355),y=i(82595),Z=i(19754),j=i(62622),T=i(11092),V=i(27791),C=i(90434),F=i(36989),J=i(59033),E=i(63765),z=i(13005),M=i.n(z),I=i(82309),D=i(40864),O=function(t){var e=t.error,i=t.width,n=t.deltaType;return e instanceof L?(0,D.jsx)(I.Z,{width:i,name:"No Mapbox token provided",message:(0,D.jsxs)(D.Fragment,{children:[(0,D.jsxs)("p",{children:["To use ",(0,D.jsxs)("code",{children:["st.",n]})," or ",(0,D.jsx)("code",{children:"st.map"})," you need to set up a Mapbox access token."]}),(0,D.jsxs)("p",{children:["To get a token, create an account at"," ",(0,D.jsx)("a",{href:"https://mapbox.com",children:"https://mapbox.com"}),". It's free for moderate usage levels!"]}),(0,D.jsxs)("p",{children:["Once you have a token, just set it using the Streamlit config option ",(0,D.jsx)("code",{children:"mapbox.token"})," and don't forget to restart your Streamlit server at this point if it's still running, then reload this tab."]}),(0,D.jsxs)("p",{children:["See"," ",(0,D.jsx)("a",{href:"https://docs.streamlit.io/library/advanced-features/configuration#view-all-configuration-options",children:"our documentation"})," ","for more info on how to set config options."]})]})}):e instanceof A?(0,D.jsx)(I.Z,{width:i,name:"Error fetching Streamlit Mapbox token",message:(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("p",{children:"This app requires an internet connection."}),(0,D.jsx)("p",{children:"Please check your connection and try again."}),(0,D.jsxs)("p",{children:["If you think this is a bug, please file bug report"," ",(0,D.jsx)("a",{href:"https://github.com/streamlit/streamlit/issues/new/choose",children:"here"}),"."]})]})}):(0,D.jsx)(I.Z,{width:i,name:"Error fetching Streamlit Mapbox token",message:e.message})},P=i(45960),N=i.n(P),_=i(66694),L=function(t){(0,r.Z)(i,t);var e=(0,s.Z)(i);function i(){return(0,o.Z)(this,i),e.apply(this,arguments)}return(0,a.Z)(i)}((0,C.Z)(Error)),A=function(t){(0,r.Z)(i,t);var e=(0,s.Z)(i);function i(){return(0,o.Z)(this,i),e.apply(this,arguments)}return(0,a.Z)(i)}((0,C.Z)(Error)),B="https://data.streamlit.io/tokens.json",G="mapbox",q=function(t){return function(e){var i=function(i){(0,r.Z)(h,i);var n=(0,s.Z)(h);function h(i){var a;return(0,o.Z)(this,h),(a=n.call(this,i)).initMapboxToken=(0,V.Z)((0,T.Z)().mark((function t(){var e,i,n;return(0,T.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,N().get(B);case 3:if(e=t.sent,i=e.data[G]){t.next=7;break}throw new Error("Missing token ".concat(G));case 7:a.setState({mapboxToken:i,isFetching:!1}),t.next=15;break;case 10:throw t.prev=10,t.t0=t.catch(0),n=(0,E.b)(t.t0),a.setState({mapboxTokenError:n,isFetching:!1}),new A("".concat(n.message," (").concat(B,")"));case 15:case"end":return t.stop()}}),t,null,[[0,10]])}))),a.render=function(){var i=a.state,n=i.mapboxToken,o=i.mapboxTokenError,r=i.isFetching,s=a.props.width;return o?(0,D.jsx)(O,{width:s,error:o,deltaType:t}):r?(0,D.jsx)(F.Z,{body:"Loading...",kind:J.h.INFO,width:s}):(0,D.jsx)(e,(0,c.Z)((0,c.Z)({},a.props),{},{mapboxToken:n,width:s}))},a.state={isFetching:!0,mapboxToken:void 0,mapboxTokenError:void 0},a}return(0,a.Z)(h,[{key:"componentDidMount",value:function(){var t=this.props.element.mapboxToken||this.context.libConfig.mapboxToken;t?this.setState({mapboxToken:t,isFetching:!1}):this.initMapboxToken()}}]),h}(h.PureComponent);return i.displayName="withMapboxToken(".concat(e.displayName||e.name,")"),i.contextType=_.E,M()(i,e)}},W=i(1515),X=(0,W.Z)("div",{target:"e1az0zs51"})((function(t){var e=t.width,i=t.height;return{marginTop:t.theme.spacing.sm,position:"relative",height:i,width:e}}),""),$=(0,W.Z)("div",{target:"e1az0zs50"})((function(t){var e=t.theme;return{position:"absolute",right:"2.625rem",top:e.spacing.md,zIndex:1,"button:not(:disabled)":{background:e.colors.bgColor,"& + button":{borderTopColor:e.colors.secondaryBg},"& span":{filter:(0,v.Iy)(e)?"":"invert(100%)"}}}}),""),H=(i(79259),{classes:(0,c.Z)((0,c.Z)((0,c.Z)((0,c.Z)({},f),k),x),b)});(0,Z.fh)([S.w,y.E]);var K=new w.Z({configuration:H}),Q=function(t){(0,r.Z)(i,t);var e=(0,s.Z)(i);function i(){var t;(0,o.Z)(this,i);for(var n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(t=e.call.apply(e,[this].concat(a))).state={viewState:{bearing:0,pitch:0,zoom:11},initialized:!1,initialViewState:{},id:void 0,pydeckJson:void 0,isFullScreen:!1,isLightTheme:(0,v.Iy)(t.props.theme)},t.componentDidMount=function(){t.setState({initialized:!0})},t.createTooltip=function(e){var i=t.props.element;if(!e||!e.object||!i.tooltip)return!1;var n=p.Z.parse(i.tooltip);return n.html?n.html=t.interpolate(e,n.html):n.text=t.interpolate(e,n.text),n},t.interpolate=function(t,e){var i=e.match(/{(.*?)}/g);return i&&i.forEach((function(i){var n=i.substring(1,i.length-1);t.object.hasOwnProperty(n)&&(e=e.replace(i,t.object[n]))})),e},t.onViewStateChange=function(e){var i=e.viewState;t.setState({viewState:i})},t}return(0,a.Z)(i,[{key:"render",value:function(){var t=i.getDeckObject(this.props,this.state),e=this.state.viewState;return(0,D.jsx)(X,{className:"stDeckGlJsonChart",width:t.initialViewState.width,height:t.initialViewState.height,"data-testid":"stDeckGlJsonChart",children:(0,D.jsxs)(l.Z,{viewState:e,onViewStateChange:this.onViewStateChange,height:t.initialViewState.height,width:t.initialViewState.width,layers:this.state.initialized?t.layers:[],getTooltip:this.createTooltip,ContextProvider:m.X$.Provider,controller:!0,children:[(0,D.jsx)(m.Z3,{height:t.initialViewState.height,width:t.initialViewState.width,mapStyle:t.mapStyle&&("string"===typeof t.mapStyle?t.mapStyle:t.mapStyle[0]),mapboxApiAccessToken:this.props.element.mapboxToken||this.props.mapboxToken}),(0,D.jsx)($,{children:(0,D.jsx)(m.Pv,{className:"zoomButton",showCompass:!1})})]})})}}],[{key:"getDerivedStateFromProps",value:function(t,e){var o=i.getDeckObject(t,e);if(!u()(o.initialViewState,e.initialViewState)){var a=Object.keys(o.initialViewState).reduce((function(t,i){return o.initialViewState[i]===e.initialViewState[i]?t:(0,c.Z)((0,c.Z)({},t),{},(0,n.Z)({},i,o.initialViewState[i]))}),{});return{viewState:(0,c.Z)((0,c.Z)({},e.viewState),a),initialViewState:o.initialViewState}}return null}}]),i}(h.PureComponent);Q.getDeckObject=function(t,e){var i,n,o,a,r,s=t.element,c=t.width,h=t.height,l=t.theme,d=t.isFullScreen,u=null!==d&&void 0!==d&&d;(s.id===e.id&&e.isFullScreen===u&&e.isLightTheme===(0,v.Iy)(l)||(e.pydeckJson=p.Z.parse(s.json),e.id=s.id),null!==(i=e.pydeckJson)&&void 0!==i&&i.mapStyle||(e.pydeckJson.mapStyle="mapbox://styles/mapbox/".concat((0,v.Iy)(l)?"light":"dark","-v9")),d)?Object.assign(null===(o=e.pydeckJson)||void 0===o?void 0:o.initialViewState,{width:c,height:h}):(null!==(a=e.pydeckJson)&&void 0!==a&&null!==(r=a.initialViewState)&&void 0!==r&&r.height||(e.pydeckJson.initialViewState.height=500),s.useContainerWidth&&(e.pydeckJson.initialViewState.width=c));return e.isFullScreen=d,e.isLightTheme=(0,v.Iy)(l),null===(n=e.pydeckJson)||void 0===n||delete n.views,K.convert(e.pydeckJson)};var R=(0,g.b)(q("st.pydeck_chart")((0,j.Z)(Q)))},2090:function(){},72709:function(){},20035:function(){},72672:function(){}}]);