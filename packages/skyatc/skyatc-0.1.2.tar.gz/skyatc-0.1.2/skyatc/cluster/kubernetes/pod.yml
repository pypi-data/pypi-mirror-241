apiVersion: node.k8s.io/v1
kind: RuntimeClass
metadata:
  name: nvidia
handler: nvidia
---
apiVersion: v1
kind: Pod
metadata:
  name: vllm
  namespace: default
spec:
  restartPolicy: OnFailure
  runtimeClassName: nvidia
  containers:
  - name: vllm-container
    image: us-central1-docker.pkg.dev/skyplane-broadcast/vllm/vllm:v1 
    args: ["nbody", "-gpu", "-benchmark"]
    command: ["python", "-m", "vllm.entrypoints.api_server", "--host", "0.0.0.0"]
    resources:
      limits:
        nvidia.com/gpu: 1
    env:
    - name: NVIDIA_VISIBLE_DEVICES
      value: all
    - name: NVIDIA_DRIVER_CAPABILITIES
      value: all
