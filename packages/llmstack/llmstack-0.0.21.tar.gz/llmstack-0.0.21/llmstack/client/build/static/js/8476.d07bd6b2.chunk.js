"use strict";(self.webpackChunkpromptmanager=self.webpackChunkpromptmanager||[]).push([[8476],{6289:function(e,n,t){t.d(n,{s:function(){return u}});var i=t(68096),a=t(30829),r=t(58406),o=t(23786),l=t(80184);function u(e){return(0,l.jsx)("div",{children:(0,l.jsxs)(i.Z,{fullWidth:!0,children:[(0,l.jsx)(a.Z,{id:"app-select-label",children:"Select an application"}),(0,l.jsx)(r.Z,{labelId:"app-select-label",id:"app-select",value:e.value,label:"Select an application",onChange:function(n){return e.onChange(n.target.value)},children:e.apps.map((function(e){return(0,l.jsx)(o.Z,{value:e.published_uuid,children:e.name},e.published_uuid)}))})]})})}},91275:function(e,n,t){t.d(n,{Z:function(){return x}});var i=t(1413),a=(t(72791),t(64554)),r=t(68096),o=t(30829),l=t(58406),u=t(23786),c=t(48550),s=t(71652),d=t(10556),p=t(72426),f=t.n(p),v=t(30815),h=t(41985),m=t(80184);function x(e){var n=e.onChange,t=e.id,p=e.value,x=e.minStartTime,Z=e.maxStartTime,j=p?JSON.parse(p):null,g=function(e){n(JSON.stringify(e))};return(0,m.jsxs)(a.Z,{sx:{display:"flex"},children:[(0,m.jsxs)(r.Z,{sx:{width:"120px"},children:[(0,m.jsx)(o.Z,{id:"".concat(t,"-label"),children:"Frequency"}),(0,m.jsxs)(l.Z,{labelId:"".concat(t,"-label"),id:t,label:"Frequency",value:(null===j||void 0===j?void 0:j.type)||"",onChange:function(e){return g({type:e.target.value})},placeholder:"Select a frequency",children:[(0,m.jsx)(u.Z,{value:"run_once",children:"Run Once"}),(0,m.jsx)(u.Z,{value:"repeat",children:"Repeat"}),(0,m.jsx)(u.Z,{value:"cron",children:"Cron Job"})]})]}),"run_once"===(null===j||void 0===j?void 0:j.type)&&(0,m.jsx)(s._,{dateAdapter:d.Q,children:(0,m.jsx)(v.x,{minDateTime:x,maxDateTime:Z,timeSteps:{minutes:15},disablePast:!0,value:f()("".concat(null===j||void 0===j?void 0:j.start_date," ").concat(null===j||void 0===j?void 0:j.start_time),"YYYY-MM-DD HH:mm:ss"),onChange:function(e){g((0,i.Z)((0,i.Z)({},j),{},{type:"run_once",start_date:e.format("YYYY-MM-DD"),start_time:e.format("HH:mm:ss")}))},label:"Schedule Time"})}),"repeat"===(null===j||void 0===j?void 0:j.type)&&(0,m.jsx)("div",{children:(0,m.jsxs)(s._,{dateAdapter:d.Q,children:[(0,m.jsx)(v.x,{minDateTime:x,maxDateTime:Z,timeSteps:{minutes:15},disablePast:!0,value:f()("".concat(null===j||void 0===j?void 0:j.start_date," ").concat(null===j||void 0===j?void 0:j.start_time),"YYYY-MM-DD HH:mm:ss"),onChange:function(e){g((0,i.Z)((0,i.Z)({},j),{},{type:"repeat",start_date:e.format("YYYY-MM-DD"),start_time:e.format("HH:mm:ss")}))},label:"Schedule Start Time"}),(0,m.jsx)(c.Z,{label:"Repeat Interval (in days)",value:null===j||void 0===j?void 0:j.interval,type:"number",onChange:function(e){return g((0,i.Z)((0,i.Z)({},j),{},{interval:e.target.value}))}}),(0,m.jsx)(h.M,{disablePast:!0,value:f()(null===j||void 0===j?void 0:j.end_date,"YYYY-MM-DD"),onChange:function(e){g((0,i.Z)((0,i.Z)({},j),{},{type:"run_once",end_date:e.format("YYYY-MM-DD")}))},label:"Schedule End Date"})]})}),"cron"===(null===j||void 0===j?void 0:j.type)&&(0,m.jsxs)(s._,{dateAdapter:d.Q,children:[(0,m.jsx)(c.Z,{label:"Cron Job Expression",value:null===j||void 0===j?void 0:j.cron_expression,onChange:function(e){return g((0,i.Z)((0,i.Z)({},j),{},{type:"cron",cron_expression:e.target.value}))}}),(0,m.jsx)(h.M,{disablePast:!0,value:f()(null===j||void 0===j?void 0:j.end_date,"YYYY-MM-DD"),onChange:function(e){g((0,i.Z)((0,i.Z)({},j),{},{type:"run_once",end_date:e.format("YYYY-MM-DD")}))},label:"Schedule End Date"})]})]})}},38476:function(e,n,t){t.r(n),t.d(n,{default:function(){return J}});var i=t(1413),a=t(29439),r=t(72791),o=t(35552),l=t(61889),u=t(36314),c=t(20890),s=t(94721),d=t(24518),p=t(81156),f=t(10752),v=t(6289),h=t(91275),m=t(75330),x=t(12705),Z=t(64554),j=t(80184),g={properties:{job_name:{type:"string",title:"Job Name"},application:{type:"string",title:"Application",widget:"appselect"},frequency:{type:"string",title:"Frequency",widget:"frequencyPicker"}}},y={"ui:order":["job_name","application","frequency"],job_name:{"ui:description":"Enter a name for this job."},application:{"ui:description":"Select an application to run.","ui:widget":"appselect"},frequency:{"ui:description":"Select a frequency to run the application.","ui:widget":"frequencyPicker"}};function b(e){var n=((0,m.sJ)(x.C_)||[]).filter((function(e){return e.published_uuid}));return(0,j.jsx)(Z.Z,{sx:{width:"95%",margin:"5px"},children:(0,j.jsx)(f.Z,{schema:g,validator:p.ZP,uiSchema:(0,i.Z)((0,i.Z)({},y),{"ui:submitButtonOptions":{norender:!0}}),formData:e.value,onChange:function(t){var a=t.formData;e.onChange((0,i.Z)((0,i.Z)({},a),{},{appDetail:n.find((function(e){return e.published_uuid===(null===a||void 0===a?void 0:a.application)})),frequencyObj:null!==a&&void 0!==a&&a.frequency?JSON.parse(null===a||void 0===a?void 0:a.frequency):null}))},widgets:{appselect:function(e){return(0,j.jsx)(v.s,(0,i.Z)((0,i.Z)({},e),{},{apps:n,value:e.value}))},frequencyPicker:function(e){return(0,j.jsx)(h.Z,(0,i.Z)((0,i.Z)({},e),{},{value:e.value,id:"frequency-picker"}))}}})})}var _=t(93433),w=t(4942),D=t(41973),C=t(5936),S=t(34265),Y=t(91330),M=t(58419),k=t(94515),q=t(5003),N=t(77763),P=t(76106),E=t(73495),O=t(21993),R=t(64721),A=t(7195),H=t(79825);function T(e){var n=e.columnData,t=e.rowData,l=e.onChange,u=(0,N.vE)().readString,c=(0,r.useState)({}),s=(0,a.Z)(c,2),p=s[0],f=s[1],v=(0,r.useRef)(null),h=(0,r.useState)(null),m=(0,a.Z)(h,2),x=m[0],g=m[1];(0,r.useEffect)((function(){if(x){var e=new FileReader;e.onload=function(e){var t=e.target.result;u(t,{header:!0,worker:!0,complete:function(e){if(0!==e.data.length){var t=Object.keys(e.data[0]);if(t.length===n.length){t.forEach((function(e){n.find((function(n){return n.headerName===e}))||(0,o.yv)("Headers do not match expected headers",{variant:"error"})}));for(var i=[],a=function(){var a=e.data[r];if(Object.keys(a).length!==t.length)return 1;var o={_id:r,_isNew:!0};n.forEach((function(e){o[e.field]=a[e.headerName]})),i.push(o)},r=0;r<e.data.length;r++)a();l(i)}else(0,o.yv)("Headers do not match expected headers",{variant:"error"})}else(0,o.yv)("No data found in file",{variant:"warning"})}})},e.readAsText(x)}}),[x,n,l,u]);var y=function(e){return function(){f((0,i.Z)((0,i.Z)({},p),{},(0,w.Z)({},e,{mode:C.se.Edit})))}},b=function(e){return function(){f((0,i.Z)((0,i.Z)({},p),{},(0,w.Z)({},e,{mode:C.se.View})))}},T=function(e){return function(){l(t.filter((function(n){return n._id!==e})))}},I=function(e){return function(){f((0,i.Z)((0,i.Z)({},p),{},(0,w.Z)({},e,{mode:C.se.View,ignoreModifications:!0}))),t.find((function(n){return n._id===e}))._isNew&&l(t.filter((function(n){return n._id!==e})))}},J=function(){v.current.click()},F=function(e){var n=e.target.files[0];g(n)};return(0,j.jsx)(Z.Z,{sx:{height:500,width:"100%","& .actions":{color:"text.secondary"},"& .textPrimary":{color:"text.primary"}},children:(0,j.jsx)(M._$,{rows:t,getRowId:function(e){return e._id},columns:[].concat((0,_.Z)(n),[{field:"actions",type:"actions",headerName:"Actions",width:100,cellClassName:"actions",getActions:function(e){var n,t=e.id;return(null===(n=p[t])||void 0===n?void 0:n.mode)===C.se.Edit?[(0,j.jsx)(k.u,{icon:(0,j.jsx)(O.Z,{}),label:"Save",sx:{color:"primary.main"},onClick:b(t)}),(0,j.jsx)(k.u,{icon:(0,j.jsx)(R.Z,{}),label:"Cancel",className:"textPrimary",onClick:I(t),color:"inherit"})]:[(0,j.jsx)(k.u,{icon:(0,j.jsx)(A.Z,{}),label:"Edit",className:"textPrimary",onClick:y(t),color:"inherit"}),(0,j.jsx)(k.u,{icon:(0,j.jsx)(H.Z,{}),label:"Delete",onClick:T(t),color:"inherit"})]}}]),editMode:"row",rowModesModel:p,onRowModesModelChange:function(e){f(e)},onRowEditStop:function(e,n){e.reason===D.U.rowFocusOut&&(n.defaultMuiPrevented=!0)},processRowUpdate:function(e){var n=(0,i.Z)((0,i.Z)({},e),{},{_isNew:!1});return l(t.map((function(t){return t._id===e._id?n:t}))),n},pageSizeOptions:[5,10],initialState:{pagination:{paginationModel:{pageSize:5}}},slots:{toolbar:function(e){var t=e.setRowModesModel;return(0,j.jsxs)(S.D,{children:[(0,j.jsx)(d.Z,{color:"primary",startIcon:(0,j.jsx)(P.Z,{}),type:"file",variant:"contained",onClick:J,children:"Upload CSV"}),(0,j.jsx)("input",{type:"file",accept:".csv",onChange:F,ref:v,style:{display:"none"}}),(0,j.jsx)(d.Z,{color:"secondary",startIcon:(0,j.jsx)(E.Z,{}),onClick:function(){var e=(0,q.kb)(),a={_id:e,_isNew:!0};n.forEach((function(e){a[e.field]=" "})),l((function(e){return[].concat((0,_.Z)(e),[a])})),t((function(t){return(0,i.Z)((0,i.Z)({},t),{},(0,w.Z)({},e,{mode:C.se.Edit,fieldToFocus:n[0].field}))}))},variant:"contained",children:"Add record"}),(0,j.jsx)(Y.Zh,{csvOptions:{includeColumnGroupsHeaders:!1,fileName:"input_data"},printOptions:{disableToolbarButton:!0}})]})}},slotProps:{toolbar:{setRowModesModel:f}}})})}var I=t(7077);function J(e){var n,t=(0,r.useState)([]),p=(0,a.Z)(t,2),f=p[0],v=p[1],h=(0,r.useState)({}),m=(0,a.Z)(h,2),x=m[0],Z=m[1],g=(0,r.useState)([]),y=(0,a.Z)(g,2),_=y[0],w=y[1];return(0,r.useEffect)((function(){if(null!==x&&void 0!==x&&x.appDetail){var e=null===x||void 0===x?void 0:x.appDetail.data.input_fields.map((function(e){return{field:e.name,headerName:e.title,width:"text"===e.type?300:200,disableColumnMenu:!0,sortable:!1,editable:!0}}));v(e),w([])}}),[x]),(0,j.jsxs)(l.ZP,{container:!0,sx:{height:"100vh"},children:[(0,j.jsx)(l.ZP,{item:!0,xs:12,sx:{height:"45%"},children:(0,j.jsxs)(u.Z,{sx:{alignItems:"start",margin:"5px"},children:[(0,j.jsx)(c.Z,{variant:"h6",sx:{marginLeft:"2px"},children:"Configuration"}),(0,j.jsx)(s.Z,{}),(0,j.jsx)(b,{onChange:function(e){Z(e)},value:x})]})}),(0,j.jsx)(l.ZP,{item:!0,xs:12,sx:{height:"45%"},children:(0,j.jsxs)(u.Z,{sx:{alignItems:"start",margin:"5px"},children:[(0,j.jsx)(c.Z,{variant:"h6",sx:{marginLeft:"2px"},children:"Input"}),(0,j.jsx)(s.Z,{}),null!==x&&void 0!==x&&x.appDetail?(0,j.jsx)(T,{columnData:f,rowData:_,onChange:function(e){w(e)}}):(0,j.jsx)("strong",{children:"Please Select And Application"})]})}),(0,j.jsx)(l.ZP,{item:!0,xs:12,sx:{height:"10%"},children:(0,j.jsx)(d.Z,{variant:"contained",color:"primary",disabled:!(null!==x&&void 0!==x&&null!==(n=x.appDetail)&&void 0!==n&&n.uuid&&null!==x&&void 0!==x&&x.frequencyObj&&_&&_.length>0),onClick:function(){var e,n=_.map((function(e){var n=(0,i.Z)({},e);return delete n._id,delete n._isNew,n}));(0,I.o)().post("/api/jobs/app_run",{job_name:null===x||void 0===x?void 0:x.job_name,app_uuid:null===x||void 0===x||null===(e=x.appDetail)||void 0===e?void 0:e.uuid,frequency:null===x||void 0===x?void 0:x.frequencyObj,app_run_data:n}).then((function(e){(0,o.yv)("Successfully Scheduled App Run",{variant:"success"}),window.location.href="/schedule"})).catch((function(e){var n,t;null!==(n=e.response)&&void 0!==n&&null!==(t=n.data)&&void 0!==t&&t.message&&(0,o.yv)(e.response.data.message,{variant:"error"})}))},children:"Submit"})})]})}}}]);
//# sourceMappingURL=8476.d07bd6b2.chunk.js.map