"use strict";(self.webpackChunkpromptmanager=self.webpackChunkpromptmanager||[]).push([[7244],{91275:function(e,n,t){t.d(n,{Z:function(){return x}});var a=t(1413),i=(t(72791),t(64554)),r=t(68096),o=t(30829),s=t(58406),u=t(23786),l=t(48550),d=t(71652),c=t(10556),v=t(72426),m=t.n(v),h=t(30815),f=t(41985),p=t(80184);function x(e){var n=e.onChange,t=e.id,v=e.value,x=e.minStartTime,g=e.maxStartTime,Z=v?JSON.parse(v):null,j=function(e){n(JSON.stringify(e))};return(0,p.jsxs)(i.Z,{sx:{display:"flex"},children:[(0,p.jsxs)(r.Z,{sx:{width:"120px"},children:[(0,p.jsx)(o.Z,{id:"".concat(t,"-label"),children:"Frequency"}),(0,p.jsxs)(s.Z,{labelId:"".concat(t,"-label"),id:t,label:"Frequency",value:(null===Z||void 0===Z?void 0:Z.type)||"",onChange:function(e){return j({type:e.target.value})},placeholder:"Select a frequency",children:[(0,p.jsx)(u.Z,{value:"run_once",children:"Run Once"}),(0,p.jsx)(u.Z,{value:"repeat",children:"Repeat"}),(0,p.jsx)(u.Z,{value:"cron",children:"Cron Job"})]})]}),"run_once"===(null===Z||void 0===Z?void 0:Z.type)&&(0,p.jsx)(d._,{dateAdapter:c.Q,children:(0,p.jsx)(h.x,{minDateTime:x,maxDateTime:g,timeSteps:{minutes:15},disablePast:!0,value:m()("".concat(null===Z||void 0===Z?void 0:Z.start_date," ").concat(null===Z||void 0===Z?void 0:Z.start_time),"YYYY-MM-DD HH:mm:ss"),onChange:function(e){j((0,a.Z)((0,a.Z)({},Z),{},{type:"run_once",start_date:e.format("YYYY-MM-DD"),start_time:e.format("HH:mm:ss")}))},label:"Schedule Time"})}),"repeat"===(null===Z||void 0===Z?void 0:Z.type)&&(0,p.jsx)("div",{children:(0,p.jsxs)(d._,{dateAdapter:c.Q,children:[(0,p.jsx)(h.x,{minDateTime:x,maxDateTime:g,timeSteps:{minutes:15},disablePast:!0,value:m()("".concat(null===Z||void 0===Z?void 0:Z.start_date," ").concat(null===Z||void 0===Z?void 0:Z.start_time),"YYYY-MM-DD HH:mm:ss"),onChange:function(e){j((0,a.Z)((0,a.Z)({},Z),{},{type:"repeat",start_date:e.format("YYYY-MM-DD"),start_time:e.format("HH:mm:ss")}))},label:"Schedule Start Time"}),(0,p.jsx)(l.Z,{label:"Repeat Interval (in days)",value:null===Z||void 0===Z?void 0:Z.interval,type:"number",onChange:function(e){return j((0,a.Z)((0,a.Z)({},Z),{},{interval:e.target.value}))}}),(0,p.jsx)(f.M,{disablePast:!0,value:m()(null===Z||void 0===Z?void 0:Z.end_date,"YYYY-MM-DD"),onChange:function(e){j((0,a.Z)((0,a.Z)({},Z),{},{type:"run_once",end_date:e.format("YYYY-MM-DD")}))},label:"Schedule End Date"})]})}),"cron"===(null===Z||void 0===Z?void 0:Z.type)&&(0,p.jsxs)(d._,{dateAdapter:c.Q,children:[(0,p.jsx)(l.Z,{label:"Cron Job Expression",value:null===Z||void 0===Z?void 0:Z.cron_expression,onChange:function(e){return j((0,a.Z)((0,a.Z)({},Z),{},{type:"cron",cron_expression:e.target.value}))}}),(0,p.jsx)(f.M,{disablePast:!0,value:m()(null===Z||void 0===Z?void 0:Z.end_date,"YYYY-MM-DD"),onChange:function(e){j((0,a.Z)((0,a.Z)({},Z),{},{type:"run_once",end_date:e.format("YYYY-MM-DD")}))},label:"Schedule End Date"})]})]})}},37244:function(e,n,t){t.r(n),t.d(n,{default:function(){return C}});var a=t(93433),i=t(29439),r=t(72791),o=t(35552),s=t(61889),u=t(36314),l=t(20890),d=t(94721),c=t(24518),v=t(58419),m=t(1413),h=t(81156),f=t(10752),p=t(91275),x=t(75330),g=t(12705),Z=t(64554),j=t(73633),y=t(72426),b=t.n(y),S=t(80184),Y={properties:{job_name:{type:"string",title:"Job Name"},datasource:{type:"string",title:"Datasource",widget:"datasource"},frequency:{type:"string",title:"Frequency",widget:"frequencyPicker"}}},_={"ui:order":["job_name","datasource","frequency"],job_name:{"ui:description":"Enter a name for this job."},datasource:{"ui:description":"Select a datasource to setup refresh.","ui:widget":"datasource"},frequency:{"ui:description":"Select a frequency to run the application.","ui:widget":"frequencyPicker"}};function D(e){var n=(0,x.sJ)(g.NM);return(0,S.jsx)(Z.Z,{sx:{width:"95%",margin:"5px"},children:(0,S.jsx)(f.Z,{schema:Y,validator:h.ZP,uiSchema:(0,m.Z)((0,m.Z)({},_),{"ui:submitButtonOptions":{norender:!0}}),formData:e.value,onChange:function(t){var a=t.formData;e.onChange((0,m.Z)((0,m.Z)({},a),{},{datasourceDetails:n.find((function(e){return e.uuid===(null===a||void 0===a?void 0:a.datasource)})),frequencyObj:null!==a&&void 0!==a&&a.frequency?JSON.parse(null===a||void 0===a?void 0:a.frequency):null}))},widgets:{datasource:function(e){return(0,S.jsx)(j.a,(0,m.Z)({multiple:!1},e))},frequencyPicker:function(e){return(0,S.jsx)(p.Z,(0,m.Z)((0,m.Z)({},e),{},{value:e.value,minStartTime:b()().add(1,"hours"),maxStartTime:b()().add(1,"years"),id:"frequency-picker"}))}}})})}var M=t(7077);function C(e){var n=(0,r.useState)({}),t=(0,i.Z)(n,2),m=t[0],h=t[1],f=(0,r.useState)([]),p=(0,i.Z)(f,2),x=p[0],g=p[1],Z=(0,r.useState)([]),j=(0,i.Z)(Z,2),y=j[0],b=j[1];return(0,r.useEffect)((function(){null!==m&&void 0!==m&&m.datasource?(0,M.o)().get("/api/datasources/".concat(null===m||void 0===m?void 0:m.datasource,"/entries")).then((function(e){g((function(n){var t=e.data.filter((function(e){return e.sync_config&&"READY"===e.status&&e.config.document_ids.length>0}));return(0,a.Z)(t)}))})).catch((function(e){var n,t;null!==(n=e.response)&&void 0!==n&&null!==(t=n.data)&&void 0!==t&&t.message&&(0,o.yv)(e.response.data.message,{variant:"error"})})):g([])}),[m]),(0,S.jsxs)(s.ZP,{container:!0,sx:{height:"100vh"},children:[(0,S.jsx)(s.ZP,{item:!0,xs:12,sx:{height:"45%"},children:(0,S.jsxs)(u.Z,{sx:{alignItems:"start",margin:"5px"},children:[(0,S.jsx)(l.Z,{variant:"h6",sx:{marginLeft:"2px"},children:"Configuration"}),(0,S.jsx)(d.Z,{}),(0,S.jsx)(D,{onChange:function(e){h(e)},value:m})]})}),(0,S.jsx)(s.ZP,{item:!0,xs:12,sx:{height:"45%"},children:(0,S.jsxs)(u.Z,{sx:{alignItems:"start",margin:"5px"},children:[(0,S.jsx)(l.Z,{variant:"h6",sx:{marginLeft:"2px"},children:"Datasource Entries"}),(0,S.jsx)(d.Z,{}),null!==m&&void 0!==m&&m.datasource?(0,S.jsx)(v._$,{checkboxSelection:!0,columns:[{field:"name",headerName:"Name",width:500},{field:"size",headerName:"Size",width:100}],initialState:{pagination:{paginationModel:{pageSize:10}}},rows:x.map((function(e){return{id:e.uuid,name:e.name,size:e.size}})),pageSizeOptions:[10],disableRowSelectionOnClick:!0,sx:{width:"100%"},rowSelectionModel:y,onRowSelectionModelChange:function(e){b(e)}}):(0,S.jsx)("strong",{children:"Please Select a Data Source"})]})}),(0,S.jsx)(s.ZP,{item:!0,xs:12,sx:{height:"10%"},children:(0,S.jsx)(c.Z,{variant:"contained",color:"primary",disabled:!(null!==m&&void 0!==m&&m.frequencyObj)||0===y.length,onClick:function(){var e;(0,M.o)().post("/api/jobs/datasource_refresh",{job_name:null===m||void 0===m?void 0:m.job_name,app_uuid:null===m||void 0===m||null===(e=m.appDetail)||void 0===e?void 0:e.uuid,frequency:null===m||void 0===m?void 0:m.frequencyObj,datasource_entries:y}).then((function(e){(0,o.yv)("Successfully Scheduled Datasource refresh",{variant:"success"}),window.location.href="/schedule"})).catch((function(e){var n,t;null!==(n=e.response)&&void 0!==n&&null!==(t=n.data)&&void 0!==t&&t.message&&(0,o.yv)(e.response.data.message,{variant:"error"})}))},children:"Submit"})})]})}}}]);
//# sourceMappingURL=7244.9e3315f3.chunk.js.map